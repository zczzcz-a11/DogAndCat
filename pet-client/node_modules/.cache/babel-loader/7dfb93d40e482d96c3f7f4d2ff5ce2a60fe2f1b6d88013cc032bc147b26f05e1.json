{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, createVNode as _createVNode, withKeys as _withKeys, withCtx as _withCtx, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-43dc8d64\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"page\"\n};\nvar _hoisted_2 = {\n  \"class\": \"header\"\n};\nvar _hoisted_3 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"i\", {\n    \"class\": \"iconfont icon-arrowLeft-fill\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_4 = [_hoisted_3];\nvar _hoisted_5 = {\n  \"class\": \"name_wrap\"\n};\nvar _hoisted_6 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    \"class\": \"tool_wrap\"\n  }, [/*#__PURE__*/_createElementVNode(\"i\", {\n    \"class\": \"iconfont icon-diandian\"\n  })], -1 /* HOISTED */);\n});\nvar _hoisted_7 = {\n  \"class\": \"content_wrap\",\n  ref: \"contentScroll\"\n};\nvar _hoisted_8 = {\n  \"class\": \"footer\"\n};\nvar _hoisted_9 = {\n  \"class\": \"item\"\n};\nvar _hoisted_10 = {\n  \"class\": \"item\"\n};\nvar _hoisted_11 = {\n  \"class\": \"input_wrap\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_ChatListVue = _resolveComponent(\"ChatListVue\");\n  var _component_van_icon = _resolveComponent(\"van-icon\");\n  var _component_van_field = _resolveComponent(\"van-field\");\n  var _component_van_cell_group = _resolveComponent(\"van-cell-group\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", {\n    onClick: _cache[0] || (_cache[0] = function ($event) {\n      return $setup.back($setup.router);\n    })\n  }, _hoisted_4), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"span\", null, _toDisplayString($setup.chatName), 1 /* TEXT */)]), _hoisted_6]), _createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_ChatListVue, {\n    recordList: _ctx.recordList\n  }, null, 8 /* PROPS */, [\"recordList\"])], 512 /* NEED_PATCH */), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_van_icon, {\n    name: \"smile\"\n  })]), _createElementVNode(\"div\", _hoisted_10, [_createVNode(_component_van_icon, {\n    name: \"add\"\n  })]), _createElementVNode(\"div\", _hoisted_11, [_createVNode(_component_van_cell_group, null, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_van_field, {\n        modelValue: _ctx.value,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n          return _ctx.value = $event;\n        }),\n        \"cursor-spacing\": \"50\",\n        \"auto-focus\": \"\",\n        onFocus: $setup.inputClick,\n        onClickInput: $setup.inputClick,\n        onKeyup: _withKeys($setup.send, [\"enter\", \"native\"])\n      }, null, 8 /* PROPS */, [\"modelValue\", \"onFocus\", \"onClickInput\", \"onKeyup\"])];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", {\n    \"class\": _normalizeClass([\"item input_btn\", _ctx.value !== '' ? 'currentInput' : '']),\n    onClick: _cache[2] || (_cache[2] = function () {\n      return $setup.send && $setup.send.apply($setup, arguments);\n    })\n  }, [_createVNode(_component_van_icon, {\n    name: \"guide-o\"\n  })], 2 /* CLASS */)])]);\n}","map":{"version":3,"names":["_createElementVNode","_hoisted_3","ref","_createElementBlock","_hoisted_1","_hoisted_2","onClick","_cache","$event","$setup","back","router","_hoisted_5","_toDisplayString","chatName","_hoisted_6","_hoisted_7","_createVNode","_component_ChatListVue","recordList","_ctx","_hoisted_8","_hoisted_9","_component_van_icon","name","_hoisted_10","_hoisted_11","_component_van_cell_group","_component_van_field","value","onFocus","inputClick","onClickInput","onKeyup","_withKeys","send","_normalizeClass","apply","arguments"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\pages\\chatPage\\index.vue"],"sourcesContent":["<template>\n  <div class=\"page\">\n    <div class=\"header\">\n      <div @click=\"back(router)\">\n        <i class=\"iconfont icon-arrowLeft-fill\"></i>\n      </div>\n      <div class=\"name_wrap\">\n        <span>{{ chatName }}</span>\n      </div>\n      <div class=\"tool_wrap\">\n        <i class=\"iconfont icon-diandian\"></i>\n      </div>\n    </div>\n\n    <div class=\"content_wrap\" ref=\"contentScroll\">\n      <ChatListVue :recordList=\"recordList\" />\n    </div>\n\n    <div class=\"footer\">\n      <div class=\"item\">\n        <van-icon name=\"smile\" />\n      </div>\n      <div class=\"item\">\n        <van-icon name=\"add\" />\n      </div>\n      <div class=\"input_wrap\">\n        <van-cell-group>\n          <van-field v-model=\"value\" cursor-spacing=\"50\" auto-focus @focus=\"inputClick\" @click-input=\"inputClick\" @keyup.enter.native=\"send\" />\n        </van-cell-group>\n      </div>\n      <div class=\"item input_btn\" :class=\"value !== '' ? 'currentInput' : ''\" @click=\"send\">\n        <van-icon name=\"guide-o\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { nextTick, onMounted, onUnmounted, reactive, ref, toRefs, watch } from 'vue'\nimport { toRelatedPage, back } from '@/router/tool.js'\nimport { useRoute, useRouter } from 'vue-router'\nimport ChatListVue from './components/ChatList.vue'\nimport { userStore } from '@/store/user.js'\n\nexport default {\n  setup(props) {\n    const route = useRoute()\n    const router = useRouter()\n    const uStore = userStore()\n    const { chatId, chatName, chatImg } = route.query\n    const state = reactive({\n      value: '',\n      contentScroll: ref(null),\n      recordList: []\n    })\n\n    uStore.setChatInfo(route.query).then(res => {\n      if (res) {\n        const list = uStore.getChatMessageList()\n        list.forEach(item => {\n          item.btnDelete = false\n        })\n        state.recordList = list\n      }\n    })\n\n    onUnmounted(() => {\n      uStore.setChatListUnreadNew()\n      uStore.setUnreadSum()\n    })\n\n    const send = () => {\n      const data = {\n        chatlistid: uStore.getChatInfoListId(),\n        msg: state.value,\n        mtime: `${new Date().getTime()}`,\n        receiver: uStore.getChatInfoName(),\n        receiverid: uStore.getChatInfoId(),\n        sender: uStore.getUserName(),\n        senderid: uStore.getUserId(),\n        senderimg: uStore.getUserImg()\n      }\n      uStore.setChatMessageList(data)\n      state.value = ''\n    }\n\n    const inputClick = () => {\n      state.contentScroll.scrollTop = state.contentScroll.scrollHeight\n    }\n\n    return {\n      ...toRefs(state),\n      router,\n      toRelatedPage,\n      send,\n      back,\n      chatName,\n      inputClick\n    }\n  },\n  components: {\n    ChatListVue\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.page {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n  display: flex;\n  flex-direction: column;\n  .header {\n    width: 100%;\n    height: 1.6rem;\n    padding: 20px;\n    box-sizing: border-box;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 0.5rem;\n    color: @color-text-header;\n    & > div > i {\n      color: @card-color;\n      font-size: 0.6rem;\n    }\n    .name_wrap {\n      color: @color-chat-title;\n      font-size: 0.55rem;\n    }\n  }\n  .content_wrap {\n    flex: 1;\n    height: calc(100% - 1.6rem - 60px);\n    background-color: @chat-bg;\n    // overflow: scroll;\n    overflow-y: scroll;\n    overflow-x: hidden;\n    position: relative;\n  }\n  .footer {\n    width: 100%;\n    height: 60px;\n    padding: 0.2rem;\n    box-sizing: border-box;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    .item {\n      width: 1rem;\n      font-size: 0.8rem;\n      color: @primary;\n    }\n    .currentInput {\n      display: block !important;\n      animation: btn 0.5s ease;\n    }\n\n    .input_btn {\n      display: none;\n    }\n    .input_wrap {\n      flex: 1;\n      overflow: hidden;\n      .van-cell-group {\n        .van-cell {\n          border-radius: 1rem;\n          background-color: @chat-bg;\n        }\n      }\n      .van-cell-group::after {\n        border: none;\n      }\n      margin-right: 0.3rem;\n    }\n  }\n}\n@keyframes btn {\n  0% {\n    width: 0;\n    transform: translateX(30%);\n    opacity: 0.2;\n  }\n  100% {\n    width: 1rem;\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n</style>\n"],"mappings":";;;;;EACO,SAAM;AAAM;;EACV,SAAM;AAAQ;;sBAEfA,mBAAA,CAA4C;IAAzC,SAAM;EAA8B;AAAA;kBAAvCC,UAA4C,C;;EAEzC,SAAM;AAAW;;sBAGtBD,mBAAA,CAEM;IAFD,SAAM;EAAW,I,aACpBA,mBAAA,CAAsC;IAAnC,SAAM;EAAwB,G;;;EAIhC,SAAM,cAAc;EAACE,GAAG,EAAC;;;EAIzB,SAAM;AAAQ;;EACZ,SAAM;AAAM;;EAGZ,SAAM;AAAM;;EAGZ,SAAM;AAAY;;;;;;uBAxB3BC,mBAAA,CAiCM,OAjCNC,UAiCM,GAhCJJ,mBAAA,CAUM,OAVNK,UAUM,GATJL,mBAAA,CAEM;IAFAM,OAAK,EAAAC,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAA,OAAEC,MAAA,CAAAC,IAAI,CAACD,MAAA,CAAAE,MAAM;IAAA;kBAGxBX,mBAAA,CAEM,OAFNY,UAEM,GADJZ,mBAAA,CAA2B,cAAAa,gBAAA,CAAlBJ,MAAA,CAAAK,QAAQ,iB,GAEnBC,UAEM,C,GAGRf,mBAAA,CAEM,OAFNgB,UAEM,GADJC,YAAA,CAAwCC,sBAAA;IAA1BC,UAAU,EAAEC,IAAA,CAAAD;EAAU,wC,yBAGtCnB,mBAAA,CAeM,OAfNqB,UAeM,GAdJrB,mBAAA,CAEM,OAFNsB,UAEM,GADJL,YAAA,CAAyBM,mBAAA;IAAfC,IAAI,EAAC;EAAO,G,GAExBxB,mBAAA,CAEM,OAFNyB,WAEM,GADJR,YAAA,CAAuBM,mBAAA;IAAbC,IAAI,EAAC;EAAK,G,GAEtBxB,mBAAA,CAIM,OAJN0B,WAIM,GAHJT,YAAA,CAEiBU,yBAAA;wBADf;MAAA,OAAqI,CAArIV,YAAA,CAAqIW,oBAAA;oBAAjHR,IAAA,CAAAS,KAAK;;iBAALT,IAAA,CAAAS,KAAK,GAAArB,MAAA;QAAA;QAAE,gBAAc,EAAC,IAAI;QAAC,YAAU,EAAV,EAAU;QAAEsB,OAAK,EAAErB,MAAA,CAAAsB,UAAU;QAAGC,YAAW,EAAEvB,MAAA,CAAAsB,UAAU;QAAGE,OAAK,EAAAC,SAAA,CAAezB,MAAA,CAAA0B,IAAI;;;;QAGrInC,mBAAA,CAEM;IAFD,SAAKoC,eAAA,EAAC,gBAAgB,EAAShB,IAAA,CAAAS,KAAK;IAAgCvB,OAAK,EAAAC,MAAA,QAAAA,MAAA;MAAA,OAAEE,MAAA,CAAA0B,IAAA,IAAA1B,MAAA,CAAA0B,IAAA,CAAAE,KAAA,CAAA5B,MAAA,EAAA6B,SAAA,CAAI;IAAA;MAClFrB,YAAA,CAA2BM,mBAAA;IAAjBC,IAAI,EAAC;EAAS,G"},"metadata":{},"sourceType":"module","externalDependencies":[]}