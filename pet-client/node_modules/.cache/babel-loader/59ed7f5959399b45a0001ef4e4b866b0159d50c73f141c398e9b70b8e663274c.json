{"ast":null,"code":"import _objectSpread from \"E:/vue3/pet-home-master/pet-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { Toast } from \"vant\";\nimport { reactive, toRefs } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { addUserPet, uploadInfo } from \"@/axios/index.js\";\nimport { uploadfile, dataURItoBlob } from \"@/utils/baseImg.js\";\nimport PageHeadVue from \"@/components/PageHead.vue\";\nimport { userStore } from \"@/store/user.js\";\nexport default {\n  setup: function setup(props) {\n    var router = useRouter();\n    var uStore = userStore();\n    var categorys = [\"犬\", \"猫\", \"鸟\", \"兔\", \"鼠\", \"鱼\"];\n    var state = reactive({\n      pageName: \"添加宠物\",\n      age: 1,\n      petImg: [],\n      petName: \"\",\n      petWeight: \"\",\n      petColor: \"\",\n      petBreed: \"\",\n      genderState: \"1\",\n      showPicker: false,\n      // 宠物种类面板的出现\n      petCategory: \"\",\n      petMessage: \"\",\n      petImgUrl: \"\"\n    });\n    var onConfirm = function onConfirm(value) {\n      // 宠物种类的确定\n      state.petCategory = value;\n      state.showPicker = false;\n      // console.log(state);\n    };\n\n    var onSubmit = function onSubmit(value) {\n      // 宠物信息提交\n      addUserPet({\n        petname: state.petName,\n        petbreed: state.petBreed,\n        petage: state.age,\n        petweight: state.petWeight,\n        petcolor: state.petColor,\n        petsex: state.genderState,\n        petcategory: state.petCategory,\n        petmessage: state.petMessage,\n        petimg: state.petImgUrl\n      }).then(function (res) {\n        Toast.success(res.mess);\n        uStore.getPetInfoSync();\n        router.back();\n      })[\"catch\"](function (err) {\n        Toast.fail(err.mess);\n      });\n    };\n    var afterReadImg = function afterReadImg(file) {\n      uploadInfo().then(function (res) {\n        var url = dataURItoBlob(file.content);\n        uploadfile(res.data, url).then(function (res) {\n          state.petImgUrl = res;\n        });\n      });\n    };\n    return _objectSpread(_objectSpread({\n      categorys: categorys\n    }, toRefs(state)), {}, {\n      onConfirm: onConfirm,\n      onSubmit: onSubmit,\n      afterReadImg: afterReadImg\n    });\n  },\n  components: {\n    PageHeadVue: PageHeadVue\n  }\n};","map":{"version":3,"names":["Toast","reactive","toRefs","useRouter","addUserPet","uploadInfo","uploadfile","dataURItoBlob","PageHeadVue","userStore","setup","props","router","uStore","categorys","state","pageName","age","petImg","petName","petWeight","petColor","petBreed","genderState","showPicker","petCategory","petMessage","petImgUrl","onConfirm","value","onSubmit","petname","petbreed","petage","petweight","petcolor","petsex","petcategory","petmessage","petimg","then","res","success","mess","getPetInfoSync","back","err","fail","afterReadImg","file","url","content","data","_objectSpread","components"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\pages\\addPet\\index.vue"],"sourcesContent":["<template>\n  <div class=\"page\">\n    <PageHeadVue :name=\"pageName\" />\n\n    <div class=\"content_wrap\">\n      <van-form @submit=\"onSubmit\" class=\"form_box\">\n        <van-cell-group inset>\n          <!-- 图片 -->\n          <van-field\n            name=\"petImg\"\n            label=\"宠物图片\"\n            :rules=\"[{ required: true, message: '请选择宠物图片' }]\"\n          >\n            <template #input>\n              <van-uploader\n                v-model=\"petImg\"\n                :max-count=\"1\"\n                :after-read=\"afterReadImg\"\n              />\n            </template>\n          </van-field>\n          <!-- 名字 -->\n          <van-field\n            v-model=\"petName\"\n            name=\"petName\"\n            label=\"宠物名\"\n            placeholder=\"宠物名\"\n            :rules=\"[{ required: true, message: '请填写宠物名' }]\"\n          />\n          <!-- 品种 -->\n          <van-field\n            v-model=\"petBreed\"\n            name=\"petBreed\"\n            label=\"宠物品种\"\n            placeholder=\"宠物品种，如‘柴犬’，‘金毛’\"\n            :rules=\"[{ required: true, message: '请填写宠物品种' }]\"\n          />\n          <!-- 颜色 -->\n          <van-field\n            v-model=\"petColor\"\n            name=\"petColor\"\n            label=\"毛色\"\n            placeholder=\"宠物毛色\"\n            :rules=\"[{ required: true, message: '请填写宠物毛色' }]\"\n          />\n          <!-- 重量 -->\n          <van-field\n            v-model=\"petWeight\"\n            name=\"petWeight\"\n            label=\"体重\"\n            type=\"number\"\n            placeholder=\"体重(kg)\"\n            :rules=\"[{ required: true, message: '请输入宠物体重' }]\"\n          />\n          <!-- 年龄 -->\n          <van-field name=\"petAge\" label=\"年龄\">\n            <template #input>\n              <van-stepper v-model=\"age\" />\n            </template>\n          </van-field>\n          <!-- 性别 -->\n          <van-field name=\"petSex\" label=\"性别\">\n            <template #input>\n              <van-radio-group v-model=\"genderState\" direction=\"horizontal\">\n                <van-radio name=\"1\" checked-color=\"#8d9f5e\">雄</van-radio>\n                <van-radio name=\"2\" checked-color=\"#8d9f5e\">雌</van-radio>\n              </van-radio-group>\n            </template>\n          </van-field>\n          <!-- 种类 -->\n          <van-field\n            v-model=\"petCategory\"\n            is-link\n            readonly\n            name=\"petCategory\"\n            label=\"种类\"\n            placeholder=\"点击选择宠物种类\"\n            @click=\"showPicker = true\"\n            :rules=\"[{ required: true, message: '请选择宠物种类' }]\"\n          />\n          <van-popup v-model:show=\"showPicker\" position=\"bottom\">\n            <van-picker\n              :columns=\"categorys\"\n              @confirm=\"onConfirm\"\n              @cancel=\"showPicker = false\"\n            />\n          </van-popup>\n          <!-- 宠物简介 -->\n          <van-field\n            name=\"petMessage\"\n            v-model=\"petMessage\"\n            rows=\"2\"\n            autosize\n            label=\"简介\"\n            type=\"textarea\"\n            maxlength=\"100\"\n            placeholder=\"关于宠物的信息\"\n            show-word-limit\n            :rules=\"[{ required: true, message: '请填写宠物简介' }]\"\n          />\n        </van-cell-group>\n\n        <div class=\"addBtn\">\n          <van-button\n            round\n            block\n            type=\"primary\"\n            native-type=\"submit\"\n            color=\"#8d9f5e\"\n          >\n            添加宠物\n          </van-button>\n        </div>\n      </van-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Toast } from \"vant\";\nimport { reactive, toRefs } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { addUserPet, uploadInfo } from \"@/axios/index.js\";\nimport { uploadfile, dataURItoBlob } from \"@/utils/baseImg.js\";\nimport PageHeadVue from \"@/components/PageHead.vue\";\nimport { userStore } from \"@/store/user.js\";\n\nexport default {\n  setup(props) {\n    const router = useRouter();\n    const uStore = userStore();\n    const categorys = [\"犬\", \"猫\", \"鸟\", \"兔\", \"鼠\", \"鱼\"];\n    const state = reactive({\n      pageName: \"添加宠物\",\n      age: 1,\n      petImg: [],\n      petName: \"\",\n      petWeight: \"\",\n      petColor: \"\",\n      petBreed: \"\",\n      genderState: \"1\",\n      showPicker: false, // 宠物种类面板的出现\n      petCategory: \"\",\n      petMessage: \"\",\n      petImgUrl: \"\",\n    });\n\n    const onConfirm = (value) => {\n      // 宠物种类的确定\n      state.petCategory = value;\n      state.showPicker = false;\n      // console.log(state);\n    };\n\n    const onSubmit = (value) => {\n      // 宠物信息提交\n      addUserPet({\n        petname: state.petName,\n        petbreed: state.petBreed,\n        petage: state.age,\n        petweight: state.petWeight,\n        petcolor: state.petColor,\n        petsex: state.genderState,\n        petcategory: state.petCategory,\n        petmessage: state.petMessage,\n        petimg: state.petImgUrl,\n      })\n        .then((res) => {\n          Toast.success(res.mess);\n          uStore.getPetInfoSync();\n          router.back();\n        })\n        .catch((err) => {\n          Toast.fail(err.mess);\n        });\n    };\n\n    const afterReadImg = (file) => {\n      uploadInfo().then(res => {\n        let url = dataURItoBlob(file.content);\n        uploadfile(res.data, url).then(res => {\n          state.petImgUrl = res;\n        })\n      })\n    };\n\n    return {\n      categorys,\n      ...toRefs(state),\n      onConfirm,\n      onSubmit,\n      afterReadImg,\n    };\n  },\n  components: {\n    PageHeadVue,\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.page {\n  width: 100%;\n  height: 100%;\n  background-color: @primary;\n  .content_wrap {\n    width: 100%;\n    height: calc(100% - 1.6rem);\n    background-color: #fff;\n    border-radius: 32px 32px 0 0;\n    border-top: 4px solid #683931;\n    padding: 40px 0px;\n    box-sizing: border-box;\n    .form_box {\n      height: 100%;\n      .addBtn {\n        width: 90%;\n        margin: 0 auto;\n        margin-top: 0.5rem;\n      }\n    }\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}