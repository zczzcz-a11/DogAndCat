{"ast":null,"code":"import { resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, KeepAlive as _KeepAlive, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_NavBarVue = _resolveComponent(\"NavBarVue\");\n  var _component_router_view = _resolveComponent(\"router-view\");\n  return _openBlock(), _createBlock(_component_router_view, null, {\n    \"default\": _withCtx(function (_ref) {\n      var Component = _ref.Component;\n      return [_createVNode(_Transition, {\n        name: \"scale\",\n        mode: \"out-in\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [(_openBlock(), _createBlock(_KeepAlive, null, [_ctx.$route.meta.keepAlive && _ctx.$route.meta.type === 'view' ? (_openBlock(), _createBlock(_resolveDynamicComponent(Component), {\n            key: 0\n          })) : _createCommentVNode(\"v-if\", true)], 1024 /* DYNAMIC_SLOTS */))];\n        }),\n\n        _: 2 /* DYNAMIC */\n      }, 1024 /* DYNAMIC_SLOTS */), _createVNode(_Transition, {\n        name: \"scale\",\n        mode: \"out-in\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [!_ctx.$route.meta.keepAlive && _ctx.$route.meta.type === 'view' ? (_openBlock(), _createBlock(_resolveDynamicComponent(Component), {\n            key: 0\n          })) : _createCommentVNode(\"v-if\", true)];\n        }),\n        _: 2 /* DYNAMIC */\n      }, 1024 /* DYNAMIC_SLOTS */), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.pageInfo, function (item) {\n        return _openBlock(), _createBlock(_Transition, {\n          key: item,\n          name: _ctx.routeType ? item[0] : item[1],\n          mode: \"out-in\"\n        }, {\n          \"default\": _withCtx(function () {\n            return [!_ctx.$route.meta.keepAlive && _ctx.$route.meta.type === item[2] ? (_openBlock(), _createBlock(_resolveDynamicComponent(Component), {\n              key: 0\n            })) : _createCommentVNode(\"v-if\", true)];\n          }),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"name\"]);\n      }), 128 /* KEYED_FRAGMENT */)), _createVNode(_Transition, {\n        name: \"move\",\n        mode: \"out-in\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_ctx.$route.meta.type === 'view' ? (_openBlock(), _createBlock(_component_NavBarVue, {\n            key: 0\n          })) : _createCommentVNode(\"v-if\", true)];\n        }),\n        _: 1 /* STABLE */\n      })];\n    }),\n\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createBlock","_component_router_view","_ref","Component","_createVNode","_Transition","name","mode","_KeepAlive","_ctx","$route","meta","keepAlive","type","_resolveDynamicComponent","key","_createElementBlock","_Fragment","_renderList","pageInfo","item","routeType","_component_NavBarVue"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\App.vue"],"sourcesContent":["<template>\n  <router-view v-slot=\"{ Component }\">\n    <transition name=\"scale\" mode=\"out-in\">\n      <keep-alive>\n        <component\n          :is=\"Component\"\n          v-if=\"$route.meta.keepAlive && $route.meta.type === 'view'\"\n        />\n      </keep-alive>\n    </transition>\n\n    <transition name=\"scale\" mode=\"out-in\">\n      <component\n        :is=\"Component\"\n        v-if=\"!$route.meta.keepAlive && $route.meta.type === 'view'\"\n      />\n    </transition>\n\n    <transition v-for=\"item in pageInfo\" :key=\"item\" :name=\"routeType ? item[0] : item[1]\" mode=\"out-in\">\n      <component\n        :is=\"Component\"\n        v-if=\"!$route.meta.keepAlive && $route.meta.type === item[2]\"\n      />\n    </transition>\n\n    <transition name=\"move\" mode=\"out-in\">\n      <NavBarVue v-if=\"$route.meta.type === 'view'\" />\n    </transition>\n  </router-view>\n</template>\n\n<script>\nimport NavBarVue from \"@/components/NavBar.vue\";\nimport { userStore } from '@/store/user.js';\nimport { useRouter } from \"vue-router\";\nimport { reactive, toRefs } from \"vue\";\n\nexport default {\n  setup(props) {\n    const uStore = userStore();\n    const router = useRouter();\n    const state = reactive({\n      routeType: true,\n      pageStackLength: 0,  // 记录页面栈的长度\n      pushType: true,      // 判断页面是前进还是后退\n      pageInfo: [\n        ['slide', 'slide', 'page'],\n        ['slide', 'scale', 'userSpace'],\n        ['scale', 'slide', 'petSpace'],\n      ]\n    });\n\n    router.beforeEach((to, from, next) => {\n      // 由 view页面进入 page页面\n      if(to.meta.type === \"petSpace\" && from.meta.type === \"view\"){\n        state.routeType = false;\n        state.pushType = true;\n      }else if(to.meta.type === \"userSpace\" && from.meta.type === \"view\"){\n        state.routeType = true;\n        state.pushType = true;\n      }\n      // 由 page页面进入 page页面\n      if ((to.meta.type === \"userSpace\" && from.meta.type === \"petSpace\") || (to.meta.type === \"petSpace\" && from.meta.type === \"userSpace\")) { \n        state.routeType = state.routeType ? false : true;\n        if((uStore.getPageStack().length > state.pageStackLength) !== state.pushType){\n          state.routeType = state.routeType ? false : true;\n        }\n        state.pushType = uStore.getPageStack().length > state.pageStackLength;\n      }\n      // 由 page页面进入 view页面\n      if(to.meta.type === \"view\" && from.meta.type === \"petSpace\"){\n        state.routeType = false;\n      }else if(to.meta.type === \"view\" && from.meta.type === \"userSpace\"){\n        state.routeType = true;\n      }\n      next();\n    });\n\n    router.afterEach( route => {\n      state.pageStackLength = uStore.getPageStack().length;\n    });\n\n    return {\n      ...toRefs(state),\n    };\n  },\n  components: {\n    NavBarVue,\n  },\n};\n</script>\n\n<style lang=\"less\">\n// 平移过渡\n.move-enter-active,\n.move-leave-active {\n  position: absolute;\n  transition: all .32s ease-out;\n}\n\n.move-enter-to,\n.move-leave-from {\n  bottom: 0;\n}\n\n.move-enter-from,\n.move-leave-to {\n  bottom: -50px;\n}\n\n// 缩放过渡\n.scale-enter-active,\n.scale-leave-active {\n  position: absolute;\n  transition: all .32s ease-out;\n}\n\n.scale-enter-from,\n.scale-leave-to {\n  opacity: 0;\n  transform: scale(0.9);\n}\n\n// 幻灯片过渡\n.slide-enter-active,\n.slide-leave-active {\n  position: absolute;\n  transition: all .32s ease-out;\n}\n\n.slide-enter-to,\n.slide-leave-from {\n  right: 0;\n  // z-index: 100;\n}\n\n.slide-enter-from,\n.slide-leave-to {\n  right: -100%;\n  // z-index: -100;\n}\n</style>\n"],"mappings":";;;;uBACEA,YAAA,CA2BcC,sBAAA;wBA1BZ,UAAAC,IAAA;MAAA,IADqBC,SAAS,GAAAD,IAAA,CAATC,SAAS;MAAA,QAC9BC,YAAA,CAOaC,WAAA;QAPDC,IAAI,EAAC,OAAO;QAACC,IAAI,EAAC;;4BAC5B;UAAA,OAKa,E,cALbP,YAAA,CAKaQ,UAAA,SAFHC,IAAA,CAAAC,MAAM,CAACC,IAAI,CAACC,SAAS,IAAIH,IAAA,CAAAC,MAAM,CAACC,IAAI,CAACE,IAAI,e,cAFjDb,YAAA,CAGEc,wBAAA,CAFKX,SAAS;YAAAY,GAAA;UAAA,M;;;;oCAMpBX,YAAA,CAKaC,WAAA;QALDC,IAAI,EAAC,OAAO;QAACC,IAAI,EAAC;;4BAC5B;UAAA,OAGE,C,CADOE,IAAA,CAAAC,MAAM,CAACC,IAAI,CAACC,SAAS,IAAIH,IAAA,CAAAC,MAAM,CAACC,IAAI,CAACE,IAAI,e,cAFlDb,YAAA,CAGEc,wBAAA,CAFKX,SAAS;YAAAY,GAAA;UAAA,M;;;uDAKlBC,mBAAA,CAKaC,SAAA,QAAAC,WAAA,CALcT,IAAA,CAAAU,QAAQ,YAAhBC,IAAI;6BAAvBpB,YAAA,CAKaK,WAAA;UALyBU,GAAG,EAAEK,IAAI;UAAGd,IAAI,EAAEG,IAAA,CAAAY,SAAS,GAAGD,IAAI,MAAMA,IAAI;UAAKb,IAAI,EAAC;;8BAC1F;YAAA,OAGE,C,CADOE,IAAA,CAAAC,MAAM,CAACC,IAAI,CAACC,SAAS,IAAIH,IAAA,CAAAC,MAAM,CAACC,IAAI,CAACE,IAAI,KAAKO,IAAI,O,cAF3DpB,YAAA,CAGEc,wBAAA,CAFKX,SAAS;cAAAY,GAAA;YAAA,M;;;;sCAKlBX,YAAA,CAEaC,WAAA;QAFDC,IAAI,EAAC,MAAM;QAACC,IAAI,EAAC;;4BAC3B;UAAA,OAAgD,CAA/BE,IAAA,CAAAC,MAAM,CAACC,IAAI,CAACE,IAAI,e,cAAjCb,YAAA,CAAgDsB,oBAAA;YAAAP,GAAA;UAAA,M"},"metadata":{},"sourceType":"module","externalDependencies":[]}