{"ast":null,"code":"import \"core-js/modules/es.parse-int.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.fill.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport { onMounted, reactive, ref } from 'vue';\nexport default {\n  __name: 'VueImageVerify',\n  emits: ['sendImgCode'],\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose,\n      emits = _ref.emit;\n    expose();\n    var verify = ref(null);\n    var state = reactive({\n      pool: 'ABDEFGHIJLMNPQRTUY23456789abdefghijmnpqrtuy',\n      imgCode: ''\n    });\n\n    // 父子组件传值的事件声明\n\n    var sendImgCode = function sendImgCode(code) {\n      emits('sendImgCode', code);\n    };\n    onMounted(function () {\n      handleDraw(); // 开始生成验证码\n    });\n\n    // 随机数\n    var randomNum = function randomNum(min, max) {\n      return parseInt(Math.random() * (max - min) + min);\n    };\n\n    // 随机生成颜色\n    var randomColor = function randomColor(min, max) {\n      var r = randomNum(min, max);\n      var g = randomNum(min, max);\n      var b = randomNum(min, max);\n      return \"rgb(\".concat(r, \",\").concat(g, \",\").concat(b, \")\");\n    };\n\n    // 绘制验证图案\n    var draw = function draw() {\n      var ctx = verify.value.getContext('2d');\n      ctx.fillStyle = randomColor(180, 230);\n      ctx.fillRect(0, 0, 120, 40);\n      var imgCode = '';\n\n      // 随机产生字符串并进行绘制\n      for (var i = 0; i < 4; i++) {\n        var text = state.pool[randomNum(0, state.pool.length)];\n        imgCode += text;\n        var fontSize = randomNum(18, 40);\n        var deg = randomNum(-30, 30);\n        ctx.font = fontSize + 'px Simhei';\n        ctx.textBaseline = 'top';\n        ctx.fillStyle = randomColor(80, 150);\n        ctx.save();\n        ctx.translate(30 * i + 15, 15);\n        ctx.rotate(deg * Math.PI / 180);\n        ctx.fillText(text, -10, -15);\n        ctx.restore();\n      }\n      // 随机产生5条干扰线,干扰线的颜色要浅一点\n      for (var _i = 0; _i < 5; _i++) {\n        ctx.beginPath();\n        ctx.moveTo(randomNum(0, 120), randomNum(0, 40));\n        ctx.lineTo(randomNum(0, 120), randomNum(0, 40));\n        ctx.strokeStyle = randomColor(180, 230);\n        ctx.closePath();\n        ctx.stroke();\n      }\n      // 随机产生40个干扰的小点\n      for (var _i2 = 0; _i2 < 40; _i2++) {\n        ctx.beginPath();\n        ctx.arc(randomNum(0, 120), randomNum(0, 40), 1, 0, 2 * Math.PI);\n        ctx.closePath();\n        ctx.fillStyle = randomColor(150, 200);\n        ctx.fill();\n      }\n      return imgCode;\n    };\n    var handleDraw = function handleDraw() {\n      state.imgCode = draw();\n      sendImgCode(state.imgCode); //  向父组件传递验证码\n    };\n\n    var __returned__ = {\n      verify: verify,\n      state: state,\n      emits: emits,\n      sendImgCode: sendImgCode,\n      randomNum: randomNum,\n      randomColor: randomColor,\n      draw: draw,\n      handleDraw: handleDraw,\n      onMounted: onMounted,\n      reactive: reactive,\n      ref: ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","reactive","ref","verify","state","pool","imgCode","sendImgCode","code","emits","handleDraw","randomNum","min","max","parseInt","Math","random","randomColor","r","g","b","concat","draw","ctx","value","getContext","fillStyle","fillRect","i","text","length","fontSize","deg","font","textBaseline","save","translate","rotate","PI","fillText","restore","beginPath","moveTo","lineTo","strokeStyle","closePath","stroke","arc","fill"],"sources":["E:/vue3/pet-home-master/pet-client/src/views/login/components/VueImageVerify.vue"],"sourcesContent":["<template>\n  <div class=\"img-verify\">\n    <canvas width=\"120\" height=\"40\" ref=\"verify\" @click=\"handleDraw\"></canvas>\n    <p class=\"text\">点击刷新验证码</p>\n  </div>\n</template>\n\n<script setup>\nimport { onMounted, reactive, ref, defineEmits } from 'vue'\n\nconst verify = ref(null)\nconst state = reactive({\n  pool: 'ABDEFGHIJLMNPQRTUY23456789abdefghijmnpqrtuy',\n  imgCode: ''\n})\n\n// 父子组件传值的事件声明\nconst emits = defineEmits(['sendImgCode'])\nconst sendImgCode = code => {\n  emits('sendImgCode', code)\n}\n\nonMounted(() => {\n  handleDraw() // 开始生成验证码\n})\n\n// 随机数\nconst randomNum = (min, max) => parseInt(Math.random() * (max - min) + min)\n\n// 随机生成颜色\nconst randomColor = (min, max) => {\n  const r = randomNum(min, max)\n  const g = randomNum(min, max)\n  const b = randomNum(min, max)\n  return `rgb(${r},${g},${b})`\n}\n\n// 绘制验证图案\nconst draw = () => {\n  const ctx = verify.value.getContext('2d')\n  ctx.fillStyle = randomColor(180, 230)\n  ctx.fillRect(0, 0, 120, 40)\n  let imgCode = ''\n\n  // 随机产生字符串并进行绘制\n  for (let i = 0; i < 4; i++) {\n    const text = state.pool[randomNum(0, state.pool.length)]\n    imgCode += text\n    const fontSize = randomNum(18, 40)\n    const deg = randomNum(-30, 30)\n    ctx.font = fontSize + 'px Simhei'\n    ctx.textBaseline = 'top'\n    ctx.fillStyle = randomColor(80, 150)\n    ctx.save()\n    ctx.translate(30 * i + 15, 15)\n    ctx.rotate((deg * Math.PI) / 180)\n    ctx.fillText(text, -10, -15)\n    ctx.restore()\n  }\n  // 随机产生5条干扰线,干扰线的颜色要浅一点\n  for (let i = 0; i < 5; i++) {\n    ctx.beginPath()\n    ctx.moveTo(randomNum(0, 120), randomNum(0, 40))\n    ctx.lineTo(randomNum(0, 120), randomNum(0, 40))\n    ctx.strokeStyle = randomColor(180, 230)\n    ctx.closePath()\n    ctx.stroke()\n  }\n  // 随机产生40个干扰的小点\n  for (let i = 0; i < 40; i++) {\n    ctx.beginPath()\n    ctx.arc(randomNum(0, 120), randomNum(0, 40), 1, 0, 2 * Math.PI)\n    ctx.closePath()\n    ctx.fillStyle = randomColor(150, 200)\n    ctx.fill()\n  }\n  return imgCode\n}\n\nconst handleDraw = () => {\n  state.imgCode = draw()\n  sendImgCode(state.imgCode) //  向父组件传递验证码\n}\n</script>\n\n<style lang=\"less\" scoped>\n.text {\n  font-size: 10px;\n  line-height: 10px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}