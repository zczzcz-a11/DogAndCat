{"ast":null,"code":"import \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/web.atob.js\";\nimport \"core-js/modules/web.dom-exception.constructor.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/web.dom-exception.to-string-tag.js\";\nimport \"core-js/modules/es.unescape.js\";\nimport \"core-js/modules/es.array-buffer.slice.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.typed-array.uint8-array.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.copy-within.js\";\nimport \"core-js/modules/es.typed-array.every.js\";\nimport \"core-js/modules/es.typed-array.fill.js\";\nimport \"core-js/modules/es.typed-array.filter.js\";\nimport \"core-js/modules/es.typed-array.find.js\";\nimport \"core-js/modules/es.typed-array.find-index.js\";\nimport \"core-js/modules/es.typed-array.find-last.js\";\nimport \"core-js/modules/es.typed-array.find-last-index.js\";\nimport \"core-js/modules/es.typed-array.for-each.js\";\nimport \"core-js/modules/es.typed-array.includes.js\";\nimport \"core-js/modules/es.typed-array.index-of.js\";\nimport \"core-js/modules/es.typed-array.iterator.js\";\nimport \"core-js/modules/es.typed-array.join.js\";\nimport \"core-js/modules/es.typed-array.last-index-of.js\";\nimport \"core-js/modules/es.typed-array.map.js\";\nimport \"core-js/modules/es.typed-array.reduce.js\";\nimport \"core-js/modules/es.typed-array.reduce-right.js\";\nimport \"core-js/modules/es.typed-array.reverse.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.slice.js\";\nimport \"core-js/modules/es.typed-array.some.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.typed-array.subarray.js\";\nimport \"core-js/modules/es.typed-array.to-locale-string.js\";\nimport \"core-js/modules/es.typed-array.to-string.js\";\nimport \"core-js/modules/esnext.typed-array.to-reversed.js\";\nimport \"core-js/modules/esnext.typed-array.to-sorted.js\";\nimport \"core-js/modules/esnext.typed-array.with.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport OSS from \"ali-oss\";\nimport { Toast } from 'vant';\nexport var dataURItoBlob = function dataURItoBlob(dataURI) {\n  // base64转 blob\n  var byteString;\n  if (dataURI.split(',')[0].indexOf('base64') >= 0) byteString = atob(dataURI.split(',')[1]);else byteString = unescape(dataURI.split(',')[1]);\n  var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n  var ia = new Uint8Array(byteString.length);\n  for (var i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n  return new Blob([ia], {\n    type: mimeString\n  });\n};\nexport var uploadfile = function uploadfile(config, file) {\n  // 使用 OSS签名，通过 FormData 提交实现图片上传\n  return new Promise(function (resolve, reject) {\n    var param = new FormData();\n    var OSSAccessKeyId = config.OSSAccessKeyId,\n      dirPath = config.dirPath,\n      host = config.host,\n      key = config.key,\n      policy = config.policy,\n      signature = config.signature,\n      success_action_status = config.success_action_status;\n    var objectKey = \"\".concat(key, \".\").concat(file.type.split('/').pop());\n    param.append('OSSAccessKeyId', OSSAccessKeyId);\n    param.append('policy', policy);\n    param.append('signature', signature);\n    param.append('key', dirPath + objectKey);\n    param.append('success_action_status', success_action_status);\n    param.append('file', file, objectKey);\n    var xhr = new XMLHttpRequest();\n    xhr.open('post', host, true);\n    xhr.addEventListener('load', function (e) {\n      if (e.target.status !== 200) {\n        Toast.fail('图片上传失败!');\n        reject(res);\n        return;\n      }\n      if (e.target.status === 200) {\n        Toast.success('图片上传成功!');\n        resolve(host + '/' + dirPath + objectKey);\n      }\n    }, false);\n    xhr.send(param);\n  });\n};","map":{"version":3,"names":["OSS","Toast","dataURItoBlob","dataURI","byteString","split","indexOf","atob","unescape","mimeString","ia","Uint8Array","length","i","charCodeAt","Blob","type","uploadfile","config","file","Promise","resolve","reject","param","FormData","OSSAccessKeyId","dirPath","host","key","policy","signature","success_action_status","objectKey","concat","pop","append","xhr","XMLHttpRequest","open","addEventListener","e","target","status","fail","res","success","send"],"sources":["E:/vue3/pet-home-master/pet-client/src/utils/baseImg.js"],"sourcesContent":["import OSS from \"ali-oss\";\nimport { Toast } from 'vant';\n\nexport const dataURItoBlob = (dataURI) => { // base64转 blob\n    let byteString;\n    if (dataURI.split(',')[0].indexOf('base64') >= 0)\n        byteString = atob(dataURI.split(',')[1]);\n    else\n        byteString = unescape(dataURI.split(',')[1]);\n\n    const mimeString = dataURI\n        .split(',')[0]\n        .split(':')[1]\n        .split(';')[0];\n\n    const ia = new Uint8Array(byteString.length);\n    for (let i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([ia], {\n        type: mimeString\n    });\n}\n\nexport const uploadfile = (config, file) => { // 使用 OSS签名，通过 FormData 提交实现图片上传\n    return new Promise((resolve, reject) => {\n        const param = new FormData();\n        const { OSSAccessKeyId, dirPath, host, key, policy, signature, success_action_status } = config;\n\n        const objectKey = `${key}.${file.type.split('/').pop()}`;\n\n        param.append('OSSAccessKeyId', OSSAccessKeyId);\n        param.append('policy', policy);\n        param.append('signature', signature);\n        param.append('key', dirPath + objectKey);\n        param.append('success_action_status', success_action_status);\n        param.append('file', file, objectKey);\n\n        const xhr = new XMLHttpRequest();\n        xhr.open('post', host, true);\n    \n        xhr.addEventListener('load', (e) => {\n            if (e.target.status !== 200) {\n                Toast.fail('图片上传失败!');\n                reject(res);\n                return;\n            }\n            if (e.target.status === 200) {\n                Toast.success('图片上传成功!');\n                resolve(host + '/' + dirPath + objectKey);\n            }\n        }, false);\n        xhr.send(param);\n    })\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}