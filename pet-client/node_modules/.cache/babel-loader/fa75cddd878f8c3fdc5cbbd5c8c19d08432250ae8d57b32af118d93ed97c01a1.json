{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, TransitionGroup as _TransitionGroup, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-06a1f20b\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"user_img\"\n};\nvar _hoisted_2 = [\"onTouchstart\"];\nvar _hoisted_3 = {\n  \"class\": \"time_wrap\"\n};\nvar _hoisted_4 = {\n  \"class\": \"content_wrap\"\n};\nvar _hoisted_5 = [\"onClick\"];\nvar _hoisted_6 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"span\", null, \"删除\", -1 /* HOISTED */);\n});\nvar _hoisted_7 = [_hoisted_6];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_van_image = _resolveComponent(\"van-image\");\n  return _openBlock(), _createElementBlock(\"div\", {\n    \"class\": \"list_page\",\n    onClick: _cache[0] || (_cache[0] = function () {\n      return $setup.initBtnDelete && $setup.initBtnDelete.apply($setup, arguments);\n    })\n  }, [_createVNode(_TransitionGroup, {\n    name: \"list\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.recordList, function (item, index) {\n        return _openBlock(), _createElementBlock(\"div\", {\n          \"class\": _normalizeClass([\"list_item\", item.sender === _ctx.userName ? 'list_item_user' : '']),\n          key: item\n        }, [_createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_van_image, {\n          width: \"1.2rem\",\n          height: \"1.2rem\",\n          fit: \"cover\",\n          src: require('@/assets/imgs/user_photo/' + item.senderimg + '.png')\n        }, null, 8 /* PROPS */, [\"src\"])]), _createElementVNode(\"div\", {\n          \"class\": \"chat_content\",\n          onTouchstart: function onTouchstart($event) {\n            return $setup.touchstart(index);\n          }\n        }, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"span\", null, _toDisplayString($setup.timeInterval(item.mtime, 1)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"span\", null, _toDisplayString(item.msg), 1 /* TEXT */), _createCommentVNode(\" <span>{{recordList}}</span> \")])], 40 /* PROPS, HYDRATE_EVENTS */, _hoisted_2), item.btnDelete ? (_openBlock(), _createElementBlock(\"div\", {\n          key: 0,\n          \"class\": \"tool_wrap\",\n          onClick: function onClick($event) {\n            return $setup.deleteRecode(item.chatrecordid);\n          }\n        }, _hoisted_7, 8 /* PROPS */, _hoisted_5)) : _createCommentVNode(\"v-if\", true)], 2 /* CLASS */);\n      }), 128 /* KEYED_FRAGMENT */))];\n    }),\n\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["_createElementVNode","_hoisted_6","_createElementBlock","onClick","_cache","$setup","initBtnDelete","apply","arguments","_createVNode","_TransitionGroup","name","_Fragment","_renderList","$props","recordList","item","index","_normalizeClass","sender","_ctx","userName","key","_hoisted_1","_component_van_image","width","height","fit","src","require","senderimg","onTouchstart","$event","touchstart","_hoisted_3","_toDisplayString","timeInterval","mtime","_hoisted_4","msg","_createCommentVNode","btnDelete","deleteRecode","chatrecordid"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\pages\\chatPage\\components\\ChatList.vue"],"sourcesContent":["<template>\n  <div class=\"list_page\" @click=\"initBtnDelete\">\n    <TransitionGroup name=\"list\">\n      <div\n        class=\"list_item\"\n        v-for=\"(item, index) in recordList\"\n        :key=\"item\"\n        :class=\"item.sender === userName ? 'list_item_user' : ''\"\n      >\n        <div class=\"user_img\">\n          <van-image\n            width=\"1.2rem\"\n            height=\"1.2rem\"\n            fit=\"cover\"\n            :src=\"\n              require('@/assets/imgs/user_photo/' + item.senderimg + '.png')\n            \"\n          />\n        </div>\n        <div class=\"chat_content\" @touchstart=\"touchstart(index)\">\n          <div class=\"time_wrap\">\n            <span>{{ timeInterval(item.mtime, 1) }}</span>\n          </div>\n          <div class=\"content_wrap\">\n            <span>{{ item.msg }}</span>\n            <!-- <span>{{recordList}}</span> -->\n          </div>\n        </div>\n        <div class=\"tool_wrap\" v-if=\"item.btnDelete\" @click=\"deleteRecode(item.chatrecordid)\">\n          <span>删除</span>\n        </div>\n      </div>\n    </TransitionGroup>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, ref } from \"vue\";\nimport { userStore } from \"@/store/user.js\";\nimport { timeInterval } from \"@/utils/tool.js\";\n\nexport default {\n  props: {\n    recordList: {\n      type: Array,\n      default: [],\n    },\n  },\n  setup(props) {\n    const uStore = userStore();\n    const state = reactive({\n      userName: uStore.getUserName(),\n      btnDelete: false\n    });\n\n    const touchstart = index => {\n      const timeout = setTimeout(() => {\n        props.recordList[index].btnDelete = true;\n      }, 1000)\n      // clearTimeout(timeout);\n    };\n\n    const initBtnDelete = () => {\n      props.recordList.forEach(item => {\n        item.btnDelete = false;\n      })\n    };\n\n    const deleteRecode = recordid => {\n      uStore.deleteRecordSync(recordid);\n    };\n\n    return {\n      ...toRefs(state),\n      timeInterval,\n      touchstart,\n      initBtnDelete,\n      deleteRecode\n    };\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.list_page {\n  width: 100%;\n  min-height: 100%;\n  padding: 0.3rem 0.1rem;\n  box-sizing: border-box;\n  .list_item {\n    width: 100%;\n    margin-bottom: 0.39rem;\n    display: flex;\n    .user_img {\n      width: 1.2rem;\n      height: 1.2rem;\n      flex: 0 0 1.2rem;\n      margin: 0 0.3rem;\n      border-radius: 50%;\n      overflow: hidden;\n    }\n    .chat_content {\n      max-width: 57%;\n      background-color: #fff;\n      padding: 0.3rem;\n      border-radius: 0 0.35rem 0.35rem 0.35rem;\n      position: relative;\n      .time_wrap {\n        color: @card-color;\n        font-size: 0.2rem;\n        margin-bottom: 0.1rem;\n      }\n      .content_wrap {\n        color: @color-chat-title;\n        font-size: 0.4rem;\n        & > span {\n          line-height: 0.46rem;\n          display: inline-block;\n          word-break: break-all;\n          white-space: normal;\n        }\n        // text-overflow: ellipsis;\n      }\n    }\n    .tool_wrap{\n      box-sizing: border-box;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      margin: 0 .3rem;\n      &>span{\n        text-align: center;\n        display: inline-block;\n        width: 0.9rem;\n        font-size: .3rem;\n        line-height: .4rem;\n        color: #fff;\n        padding: .2rem .3rem;\n        border-radius: .3rem;\n        background-color:@btn-delete;\n        \n      }\n    }\n  }\n  .list_item_user {\n    flex-direction: row-reverse;\n    .chat_content {\n      border-radius: 0.35rem 0 0.35rem 0.35rem;\n      background-color: @primary;\n      .time_wrap {\n        color: @color-text-header;\n      }\n      .content_wrap {\n        color: #fff;\n      }\n    }\n  }\n}\n\n.list-move, /* 对移动中的元素应用的过渡 */\n.list-enter-active {\n  transition: all 0.5s ease;\n}\n.list-leave-active {\n  transition: all 0.5s cubic-bezier(0.55, 0, 0.1, 1);\n}\n\n.list-enter-from {\n  opacity: 0;\n  transform: translateX(30px);\n}\n.list-leave-to {\n  opacity: 0;\n  transform: scaleY(0.01) translate(30px, 0);\n}\n\n/* 确保将离开的元素从布局流中删除\n  以便能够正确地计算移动的动画。 */\n.list-leave-active {\n  position: absolute;\n}\n</style>\n"],"mappings":";;;;;EASa,SAAM;AAAU;;;EAWd,SAAM;AAAW;;EAGjB,SAAM;AAAc;;;sBAMzBA,mBAAA,CAAe,cAAT,IAAE;AAAA;kBAARC,UAAe,C;;;uBA5BvBC,mBAAA,CAgCM;IAhCD,SAAM,WAAW;IAAEC,OAAK,EAAAC,MAAA,QAAAA,MAAA;MAAA,OAAEC,MAAA,CAAAC,aAAA,IAAAD,MAAA,CAAAC,aAAA,CAAAC,KAAA,CAAAF,MAAA,EAAAG,SAAA,CAAa;IAAA;MAC1CC,YAAA,CA8BkBC,gBAAA;IA9BDC,IAAI,EAAC;EAAM;wBAGxB;MAAA,OAAmC,E,kBAFrCT,mBAAA,CA4BMU,SAAA,QAAAC,WAAA,CA1BoBC,MAAA,CAAAC,UAAU,YAA1BC,IAAI,EAAEC,KAAK;6BAFrBf,mBAAA,CA4BM;UA3BJ,SAAKgB,eAAA,EAAC,WAAW,EAGTF,IAAI,CAACG,MAAM,KAAKC,IAAA,CAAAC,QAAQ;UAD/BC,GAAG,EAAEN;YAGNhB,mBAAA,CASM,OATNuB,UASM,GARJd,YAAA,CAOEe,oBAAA;UANAC,KAAK,EAAC,QAAQ;UACdC,MAAM,EAAC,QAAQ;UACfC,GAAG,EAAC,OAAO;UACVC,GAAG,EAAiBC,OAAO,+BAA+Bb,IAAI,CAACc,SAAS;4CAK7E9B,mBAAA,CAQM;UARD,SAAM,cAAc;UAAE+B,YAAU,WAAAA,aAAAC,MAAA;YAAA,OAAE3B,MAAA,CAAA4B,UAAU,CAAChB,KAAK;UAAA;YACrDjB,mBAAA,CAEM,OAFNkC,UAEM,GADJlC,mBAAA,CAA8C,cAAAmC,gBAAA,CAArC9B,MAAA,CAAA+B,YAAY,CAACpB,IAAI,CAACqB,KAAK,qB,GAElCrC,mBAAA,CAGM,OAHNsC,UAGM,GAFJtC,mBAAA,CAA2B,cAAAmC,gBAAA,CAAlBnB,IAAI,CAACuB,GAAG,kBACjBC,mBAAA,iCAAoC,C,iDAGXxB,IAAI,CAACyB,SAAS,I,cAA3CvC,mBAAA,CAEM;;UAFD,SAAM,WAAW;UAAwBC,OAAK,WAAAA,QAAA6B,MAAA;YAAA,OAAE3B,MAAA,CAAAqC,YAAY,CAAC1B,IAAI,CAAC2B,YAAY;UAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}