{"ast":null,"code":"import _objectSpread from \"E:/vue3/pet-home-master/pet-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport NavBarVue from \"@/components/NavBar.vue\";\nimport { userStore } from '@/store/user.js';\nimport { useRouter } from \"vue-router\";\nimport { reactive, toRefs } from \"vue\";\nexport default {\n  setup: function setup(props) {\n    var uStore = userStore();\n    var router = useRouter();\n    var state = reactive({\n      routeType: true,\n      pageStackLength: 0,\n      // 记录页面栈的长度\n      pushType: true,\n      // 判断页面是前进还是后退\n      pageInfo: [['slide', 'slide', 'page'], ['slide', 'scale', 'userSpace'], ['scale', 'slide', 'petSpace']]\n    });\n    router.beforeEach(function (to, from, next) {\n      // 由 view页面进入 page页面\n      if (to.meta.type === \"petSpace\" && from.meta.type === \"view\") {\n        state.routeType = false;\n        state.pushType = true;\n      } else if (to.meta.type === \"userSpace\" && from.meta.type === \"view\") {\n        state.routeType = true;\n        state.pushType = true;\n      }\n      // 由 page页面进入 page页面\n      if (to.meta.type === \"userSpace\" && from.meta.type === \"petSpace\" || to.meta.type === \"petSpace\" && from.meta.type === \"userSpace\") {\n        state.routeType = state.routeType ? false : true;\n        if (uStore.getPageStack().length > state.pageStackLength !== state.pushType) {\n          state.routeType = state.routeType ? false : true;\n        }\n        state.pushType = uStore.getPageStack().length > state.pageStackLength;\n      }\n      // 由 page页面进入 view页面\n      if (to.meta.type === \"view\" && from.meta.type === \"petSpace\") {\n        state.routeType = false;\n      } else if (to.meta.type === \"view\" && from.meta.type === \"userSpace\") {\n        state.routeType = true;\n      }\n      next();\n    });\n    router.afterEach(function (route) {\n      state.pageStackLength = uStore.getPageStack().length;\n    });\n    return _objectSpread({}, toRefs(state));\n  },\n  components: {\n    NavBarVue: NavBarVue\n  }\n};","map":{"version":3,"names":["NavBarVue","userStore","useRouter","reactive","toRefs","setup","props","uStore","router","state","routeType","pageStackLength","pushType","pageInfo","beforeEach","to","from","next","meta","type","getPageStack","length","afterEach","route","_objectSpread","components"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\App.vue"],"sourcesContent":["<template>\n  <router-view v-slot=\"{ Component }\">\n    <transition name=\"scale\" mode=\"out-in\">\n      <keep-alive>\n        <component\n          :is=\"Component\"\n          v-if=\"$route.meta.keepAlive && $route.meta.type === 'view'\"\n        />\n      </keep-alive>\n    </transition>\n\n    <transition name=\"scale\" mode=\"out-in\">\n      <component\n        :is=\"Component\"\n        v-if=\"!$route.meta.keepAlive && $route.meta.type === 'view'\"\n      />\n    </transition>\n\n    <transition v-for=\"item in pageInfo\" :key=\"item\" :name=\"routeType ? item[0] : item[1]\" mode=\"out-in\">\n      <component\n        :is=\"Component\"\n        v-if=\"!$route.meta.keepAlive && $route.meta.type === item[2]\"\n      />\n    </transition>\n\n    <transition name=\"move\" mode=\"out-in\">\n      <NavBarVue v-if=\"$route.meta.type === 'view'\" />\n    </transition>\n  </router-view>\n</template>\n\n<script>\nimport NavBarVue from \"@/components/NavBar.vue\";\nimport { userStore } from '@/store/user.js';\nimport { useRouter } from \"vue-router\";\nimport { reactive, toRefs } from \"vue\";\n\nexport default {\n  setup(props) {\n    const uStore = userStore();\n    const router = useRouter();\n    const state = reactive({\n      routeType: true,\n      pageStackLength: 0,  // 记录页面栈的长度\n      pushType: true,      // 判断页面是前进还是后退\n      pageInfo: [\n        ['slide', 'slide', 'page'],\n        ['slide', 'scale', 'userSpace'],\n        ['scale', 'slide', 'petSpace'],\n      ]\n    });\n\n    router.beforeEach((to, from, next) => {\n      // 由 view页面进入 page页面\n      if(to.meta.type === \"petSpace\" && from.meta.type === \"view\"){\n        state.routeType = false;\n        state.pushType = true;\n      }else if(to.meta.type === \"userSpace\" && from.meta.type === \"view\"){\n        state.routeType = true;\n        state.pushType = true;\n      }\n      // 由 page页面进入 page页面\n      if ((to.meta.type === \"userSpace\" && from.meta.type === \"petSpace\") || (to.meta.type === \"petSpace\" && from.meta.type === \"userSpace\")) { \n        state.routeType = state.routeType ? false : true;\n        if((uStore.getPageStack().length > state.pageStackLength) !== state.pushType){\n          state.routeType = state.routeType ? false : true;\n        }\n        state.pushType = uStore.getPageStack().length > state.pageStackLength;\n      }\n      // 由 page页面进入 view页面\n      if(to.meta.type === \"view\" && from.meta.type === \"petSpace\"){\n        state.routeType = false;\n      }else if(to.meta.type === \"view\" && from.meta.type === \"userSpace\"){\n        state.routeType = true;\n      }\n      next();\n    });\n\n    router.afterEach( route => {\n      state.pageStackLength = uStore.getPageStack().length;\n    });\n\n    return {\n      ...toRefs(state),\n    };\n  },\n  components: {\n    NavBarVue,\n  },\n};\n</script>\n\n<style lang=\"less\">\n// 平移过渡\n.move-enter-active,\n.move-leave-active {\n  position: absolute;\n  transition: all .32s ease-out;\n}\n\n.move-enter-to,\n.move-leave-from {\n  bottom: 0;\n}\n\n.move-enter-from,\n.move-leave-to {\n  bottom: -50px;\n}\n\n// 缩放过渡\n.scale-enter-active,\n.scale-leave-active {\n  position: absolute;\n  transition: all .32s ease-out;\n}\n\n.scale-enter-from,\n.scale-leave-to {\n  opacity: 0;\n  transform: scale(0.9);\n}\n\n// 幻灯片过渡\n.slide-enter-active,\n.slide-leave-active {\n  position: absolute;\n  transition: all .32s ease-out;\n}\n\n.slide-enter-to,\n.slide-leave-from {\n  right: 0;\n  // z-index: 100;\n}\n\n.slide-enter-from,\n.slide-leave-to {\n  right: -100%;\n  // z-index: -100;\n}\n</style>\n"],"mappings":";AAgCA,OAAOA,SAAQ,MAAO,yBAAyB;AAC/C,SAASC,SAAQ,QAAS,iBAAiB;AAC3C,SAASC,SAAQ,QAAS,YAAY;AACtC,SAASC,QAAQ,EAAEC,MAAK,QAAS,KAAK;AAEtC,eAAe;EACbC,KAAK,WAAAA,MAACC,KAAK,EAAE;IACX,IAAMC,MAAK,GAAIN,SAAS,EAAE;IAC1B,IAAMO,MAAK,GAAIN,SAAS,EAAE;IAC1B,IAAMO,KAAI,GAAIN,QAAQ,CAAC;MACrBO,SAAS,EAAE,IAAI;MACfC,eAAe,EAAE,CAAC;MAAG;MACrBC,QAAQ,EAAE,IAAI;MAAO;MACrBC,QAAQ,EAAE,CACR,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,EAC1B,CAAC,OAAO,EAAE,OAAO,EAAE,WAAW,CAAC,EAC/B,CAAC,OAAO,EAAE,OAAO,EAAE,UAAU,CAAC;IAElC,CAAC,CAAC;IAEFL,MAAM,CAACM,UAAU,CAAC,UAACC,EAAE,EAAEC,IAAI,EAAEC,IAAI,EAAK;MACpC;MACA,IAAGF,EAAE,CAACG,IAAI,CAACC,IAAG,KAAM,UAAS,IAAKH,IAAI,CAACE,IAAI,CAACC,IAAG,KAAM,MAAM,EAAC;QAC1DV,KAAK,CAACC,SAAQ,GAAI,KAAK;QACvBD,KAAK,CAACG,QAAO,GAAI,IAAI;MACvB,CAAC,MAAK,IAAGG,EAAE,CAACG,IAAI,CAACC,IAAG,KAAM,WAAU,IAAKH,IAAI,CAACE,IAAI,CAACC,IAAG,KAAM,MAAM,EAAC;QACjEV,KAAK,CAACC,SAAQ,GAAI,IAAI;QACtBD,KAAK,CAACG,QAAO,GAAI,IAAI;MACvB;MACA;MACA,IAAKG,EAAE,CAACG,IAAI,CAACC,IAAG,KAAM,WAAU,IAAKH,IAAI,CAACE,IAAI,CAACC,IAAG,KAAM,UAAU,IAAMJ,EAAE,CAACG,IAAI,CAACC,IAAG,KAAM,UAAS,IAAKH,IAAI,CAACE,IAAI,CAACC,IAAG,KAAM,WAAY,EAAE;QACtIV,KAAK,CAACC,SAAQ,GAAID,KAAK,CAACC,SAAQ,GAAI,KAAI,GAAI,IAAI;QAChD,IAAIH,MAAM,CAACa,YAAY,EAAE,CAACC,MAAK,GAAIZ,KAAK,CAACE,eAAe,KAAMF,KAAK,CAACG,QAAQ,EAAC;UAC3EH,KAAK,CAACC,SAAQ,GAAID,KAAK,CAACC,SAAQ,GAAI,KAAI,GAAI,IAAI;QAClD;QACAD,KAAK,CAACG,QAAO,GAAIL,MAAM,CAACa,YAAY,EAAE,CAACC,MAAK,GAAIZ,KAAK,CAACE,eAAe;MACvE;MACA;MACA,IAAGI,EAAE,CAACG,IAAI,CAACC,IAAG,KAAM,MAAK,IAAKH,IAAI,CAACE,IAAI,CAACC,IAAG,KAAM,UAAU,EAAC;QAC1DV,KAAK,CAACC,SAAQ,GAAI,KAAK;MACzB,CAAC,MAAK,IAAGK,EAAE,CAACG,IAAI,CAACC,IAAG,KAAM,MAAK,IAAKH,IAAI,CAACE,IAAI,CAACC,IAAG,KAAM,WAAW,EAAC;QACjEV,KAAK,CAACC,SAAQ,GAAI,IAAI;MACxB;MACAO,IAAI,EAAE;IACR,CAAC,CAAC;IAEFT,MAAM,CAACc,SAAS,CAAE,UAAAC,KAAI,EAAK;MACzBd,KAAK,CAACE,eAAc,GAAIJ,MAAM,CAACa,YAAY,EAAE,CAACC,MAAM;IACtD,CAAC,CAAC;IAEF,OAAAG,aAAA,KACKpB,MAAM,CAACK,KAAK,CAAC;EAEpB,CAAC;EACDgB,UAAU,EAAE;IACVzB,SAAS,EAATA;EACF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}