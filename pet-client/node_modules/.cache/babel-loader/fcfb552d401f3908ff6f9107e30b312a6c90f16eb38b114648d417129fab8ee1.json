{"ast":null,"code":"import \"core-js/modules/es.array.sort.js\";\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-0865a39c\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"page\"\n};\nvar _hoisted_2 = {\n  \"class\": \"header\"\n};\nvar _hoisted_3 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"p\", {\n    \"class\": \"title\"\n  }, \"喜爱\", -1 /* HOISTED */);\n});\nvar _hoisted_4 = {\n  \"class\": \"content_wrap\"\n};\nvar _hoisted_5 = {\n  \"class\": \"tool_wrap\"\n};\nvar _hoisted_6 = {\n  key: 0,\n  \"class\": \"content\"\n};\nvar _hoisted_7 = {\n  key: 1,\n  \"class\": \"content_sheleton\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_van_icon = _resolveComponent(\"van-icon\");\n  var _component_van_dropdown_item = _resolveComponent(\"van-dropdown-item\");\n  var _component_van_dropdown_menu = _resolveComponent(\"van-dropdown-menu\");\n  var _component_van_sticky = _resolveComponent(\"van-sticky\");\n  var _component_PetCardVue = _resolveComponent(\"PetCardVue\");\n  var _component_SkeletonVue = _resolveComponent(\"SkeletonVue\");\n  var _component_van_empty = _resolveComponent(\"van-empty\");\n  var _component_van_pull_refresh = _resolveComponent(\"van-pull-refresh\");\n  var _component_van_action_sheet = _resolveComponent(\"van-action-sheet\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_van_pull_refresh, {\n    modelValue: _ctx.loading,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return _ctx.loading = $event;\n    }),\n    onRefresh: $setup.onRefresh\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createVNode(_component_van_icon, {\n        name: \"search\"\n      })]), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_van_sticky, null, {\n        \"default\": _withCtx(function () {\n          return [_createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_van_dropdown_menu, {\n            \"active-color\": \"#f8b158\"\n          }, {\n            \"default\": _withCtx(function () {\n              return [_createVNode(_component_van_dropdown_item, {\n                modelValue: _ctx.type,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n                  return _ctx.type = $event;\n                }),\n                options: _ctx.optionType\n              }, null, 8 /* PROPS */, [\"modelValue\", \"options\"]), _createVNode(_component_van_dropdown_item, {\n                modelValue: _ctx.sort,\n                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n                  return _ctx.sort = $event;\n                }),\n                options: _ctx.optionSort\n              }, null, 8 /* PROPS */, [\"modelValue\", \"options\"])];\n            }),\n            _: 1 /* STABLE */\n          })])];\n        }),\n\n        _: 1 /* STABLE */\n      }), _ctx.petFondList.length !== 0 && _ctx.refreshPage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.petFondList, function (item) {\n        return _openBlock(), _createElementBlock(\"div\", {\n          \"class\": \"item\",\n          key: item.petid\n        }, [_createVNode(_component_PetCardVue, {\n          petItem: item,\n          petCollect: false,\n          onOpen: $setup.sheetOpen\n        }, null, 8 /* PROPS */, [\"petItem\", \"onOpen\"])]);\n      }), 128 /* KEYED_FRAGMENT */))])) : !_ctx.refreshPage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createVNode(_component_SkeletonVue)])) : _ctx.petFondList.length == 0 ? (_openBlock(), _createBlock(_component_van_empty, {\n        key: 2,\n        \"class\": \"custom-image\",\n        image: require('@/assets/imgs/page/empty.png'),\n        description: \"没有什么也没有汪\"\n      }, null, 8 /* PROPS */, [\"image\"])) : _createCommentVNode(\"v-if\", true)])];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"onRefresh\"]), _createVNode(_component_van_action_sheet, {\n    show: _ctx.show,\n    actions: _ctx.actions,\n    onCancel: $setup.onClose,\n    onSelect: $setup.onSelect,\n    \"cancel-text\": \"取消\"\n  }, null, 8 /* PROPS */, [\"show\", \"actions\", \"onCancel\", \"onSelect\"])]);\n}","map":{"version":3,"names":["_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_van_pull_refresh","_ctx","loading","$event","onRefresh","$setup","_hoisted_2","_hoisted_3","_component_van_icon","name","_hoisted_4","_component_van_sticky","_hoisted_5","_component_van_dropdown_menu","_component_van_dropdown_item","type","options","optionType","sort","optionSort","petFondList","length","refreshPage","_hoisted_6","_Fragment","_renderList","item","key","petid","_component_PetCardVue","petItem","petCollect","onOpen","sheetOpen","_hoisted_7","_component_SkeletonVue","_createBlock","_component_van_empty","image","require","description","_component_van_action_sheet","show","actions","onCancel","onClose","onSelect"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\views\\fond\\index.vue"],"sourcesContent":["<template>\n  <div class=\"page\">\n    <van-pull-refresh v-model=\"loading\" @refresh=\"onRefresh\">\n      <div class=\"header\">\n        <p class=\"title\">喜爱</p>\n        <van-icon name=\"search\" />\n      </div>\n\n      <div class=\"content_wrap\">\n        <van-sticky>\n          <div class=\"tool_wrap\">\n            <van-dropdown-menu active-color=\"#f8b158\">\n              <van-dropdown-item v-model=\"type\" :options=\"optionType\" />\n              <van-dropdown-item v-model=\"sort\" :options=\"optionSort\" />\n            </van-dropdown-menu>\n          </div>\n        </van-sticky>\n\n        <div class=\"content\" v-if=\"petFondList.length !== 0 && refreshPage\">\n          <div class=\"item\" v-for=\"item in petFondList\" :key=\"item.petid\">\n            <PetCardVue :petItem=\"item\" :petCollect=\"false\" @open=\"sheetOpen\" />\n          </div>\n        </div>\n\n        <div class=\"content_sheleton\" v-else-if=\"!refreshPage\">\n          <SkeletonVue />\n        </div>\n\n        <van-empty class=\"custom-image\" :image=\"require('@/assets/imgs/page/empty.png')\" description=\"没有什么也没有汪\" v-else-if=\"petFondList.length == 0\" />\n      </div>\n    </van-pull-refresh>\n\n    <van-action-sheet :show=\"show\" :actions=\"actions\" @cancel=\"onClose\" @select=\"onSelect\" cancel-text=\"取消\" />\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, watch } from 'vue'\nimport PetCardVue from '@/components/PetCard.vue'\nimport { userStore } from '@/store/user.js'\nimport { Dialog, Toast } from 'vant'\nimport SkeletonVue from '@/views/home/components/Skeleton.vue'\n\nexport default {\n  setup(props) {\n    const uStore = userStore()\n    const state = reactive({\n      loading: false, // 下来刷新的状态\n      optionType: [\n        { text: '全部', value: 'all' },\n        { text: '类别：犬', value: '犬' },\n        { text: '类别：猫', value: '猫' },\n        { text: '类别：鸟', value: '鸟' },\n        { text: '类别：兔', value: '兔' },\n        { text: '类别：鼠', value: '鼠' },\n        { text: '类别：鱼', value: '鱼' }\n      ],\n      optionSort: [\n        { text: '时间排序', value: 'time' },\n        { text: '喜爱排序', value: 'fond' }\n      ],\n      type: 'all',\n      sort: 'time',\n      petFondList: [],\n      show: false,\n      actions: [\n        {\n          name: '取消喜爱'\n        }\n      ],\n      actionPetId: '',\n      refreshPage: true // 当前页面是否刷新\n    })\n\n    let list = []\n\n    const setPetFondList = list => {\n      state.petFondList =\n        state.type === 'all'\n          ? list\n          : list.filter(value => {\n              return value.petcategory === state.type\n            })\n    }\n\n    const initFondList = () => {\n      uStore.getFondInfoSync().then(res => {\n        list = uStore.getFondInfo()\n        setPetFondList(list)\n      })\n    }\n\n    initFondList()\n\n    watch(\n      [() => state.type, () => state.sort],\n      (newVal, oldVal) => {\n        list = uStore.getFondInfo()\n        if (newVal[1] === 'time') {\n          list = list.sort((a, b) => {\n            return b.ctime - a.ctime\n          })\n        }\n        setPetFondList(list)\n      },\n      { deep: true, immediate: true }\n    )\n\n    const sheetOpen = e => {\n      state.show = e.type\n      state.actionPetId = e.petid\n    }\n\n    const onClose = () => {\n      state.show = false\n    }\n\n    const onSelect = e => {\n      if (e.name === '取消喜爱') {\n        Dialog.confirm({\n          message: '确定将宠物移除吗？'\n        })\n          .then(() => {\n            // console.log(state.actionPetId);\n            uStore.setUserCollect(state.actionPetId)\n            const type = state.type\n            state.type = '0'\n            state.type = type\n            state.show = false\n          })\n          .catch(() => {\n            state.show = false\n          })\n      }\n    }\n\n    const onRefresh = () => {\n      // 下拉刷新\n      initFondList()\n      state.refreshPage = false\n      setTimeout(() => {\n        const type = state.type\n        state.type = '0'\n        state.type = type\n        state.refreshPage = true\n        Toast('刷新成功')\n        state.loading = false\n      }, 1000)\n    }\n\n    return {\n      ...toRefs(state),\n      onClose,\n      onSelect,\n      sheetOpen,\n      onRefresh\n    }\n  },\n  components: {\n    PetCardVue,\n    SkeletonVue\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.page {\n  width: 100%;\n  height: calc(100% - 50px);\n  background-color: @primary;\n  .header {\n    width: 100%;\n    height: 60px;\n    display: flex;\n    padding: 20px;\n    box-sizing: border-box;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 0.5rem;\n    color: @color-text-header;\n  }\n  .content_wrap {\n    width: 100%;\n    min-height: calc(100vh - 110px);\n    background-color: #fff;\n    border-radius: 32px 32px 0 0;\n    overflow: hidden;\n    border-top: 4px solid #683931;\n    .tool_wrap {\n      margin-bottom: 15px;\n      :deep(.van-dropdown-menu__title) {\n        color: @card-color;\n      }\n    }\n    .content {\n      width: 100%;\n      overflow: scroll;\n      display: grid;\n      grid-template-columns: 50% 50%;\n      justify-items: center;\n      margin-bottom: 60px;\n      .item {\n        width: 91%;\n        margin-bottom: 20px;\n      }\n    }\n    .content_sheleton {\n      width: 100%;\n      height: calc(100vh - 158px);\n    }\n  }\n}\n:deep(.van-empty__image) {\n  opacity: 0.3;\n}\n:deep(.van-pull-refresh__head) {\n  color: #fff;\n}\n:deep(.van-loading) {\n  & > span {\n    color: #fff;\n  }\n}\n</style>\n"],"mappings":";;;;;;EACO,SAAM;AAAM;;EAER,SAAM;AAAQ;;sBACjBA,mBAAA,CAAuB;IAApB,SAAM;EAAO,GAAC,IAAE;AAAA;;EAIhB,SAAM;AAAc;;EAEhB,SAAM;AAAW;;;EAQnB,SAAM;;;;EAMN,SAAM;;;;;;;;;;;;uBAvBjBC,mBAAA,CAgCM,OAhCNC,UAgCM,GA/BJC,YAAA,CA4BmBC,2BAAA;gBA5BQC,IAAA,CAAAC,OAAO;;aAAPD,IAAA,CAAAC,OAAO,GAAAC,MAAA;IAAA;IAAGC,SAAO,EAAEC,MAAA,CAAAD;;wBAC5C;MAAA,OAGM,CAHNR,mBAAA,CAGM,OAHNU,UAGM,GAFJC,UAAuB,EACvBR,YAAA,CAA0BS,mBAAA;QAAhBC,IAAI,EAAC;MAAQ,G,GAGzBb,mBAAA,CAqBM,OArBNc,UAqBM,GApBJX,YAAA,CAOaY,qBAAA;4BANX;UAAA,OAKM,CALNf,mBAAA,CAKM,OALNgB,UAKM,GAJJb,YAAA,CAGoBc,4BAAA;YAHD,cAAY,EAAC;UAAS;gCACvC;cAAA,OAA0D,CAA1Dd,YAAA,CAA0De,4BAAA;4BAA9Bb,IAAA,CAAAc,IAAI;;yBAAJd,IAAA,CAAAc,IAAI,GAAAZ,MAAA;gBAAA;gBAAGa,OAAO,EAAEf,IAAA,CAAAgB;kEAC5ClB,YAAA,CAA0De,4BAAA;4BAA9Bb,IAAA,CAAAiB,IAAI;;yBAAJjB,IAAA,CAAAiB,IAAI,GAAAf,MAAA;gBAAA;gBAAGa,OAAO,EAAEf,IAAA,CAAAkB;;;;;;;;UAKvBlB,IAAA,CAAAmB,WAAW,CAACC,MAAM,UAAUpB,IAAA,CAAAqB,WAAW,I,cAAlEzB,mBAAA,CAIM,OAJN0B,UAIM,I,kBAHJ1B,mBAAA,CAEM2B,SAAA,QAAAC,WAAA,CAF2BxB,IAAA,CAAAmB,WAAW,YAAnBM,IAAI;6BAA7B7B,mBAAA,CAEM;UAFD,SAAM,MAAM;UAA8B8B,GAAG,EAAED,IAAI,CAACE;YACvD7B,YAAA,CAAoE8B,qBAAA;UAAvDC,OAAO,EAAEJ,IAAI;UAAGK,UAAU,EAAE,KAAK;UAAGC,MAAI,EAAE3B,MAAA,CAAA4B;;2CAIjBhC,IAAA,CAAAqB,WAAW,I,cAArDzB,mBAAA,CAEM,OAFNqC,UAEM,GADJnC,YAAA,CAAeoC,sBAAA,E,KAGkGlC,IAAA,CAAAmB,WAAW,CAACC,MAAM,S,cAArIe,YAAA,CAA8IC,oBAAA;;QAAnI,SAAM,cAAc;QAAEC,KAAK,EAAEC,OAAO;QAAkCC,WAAW,EAAC;;;;kDAIjGzC,YAAA,CAA0G0C,2BAAA;IAAvFC,IAAI,EAAEzC,IAAA,CAAAyC,IAAI;IAAGC,OAAO,EAAE1C,IAAA,CAAA0C,OAAO;IAAGC,QAAM,EAAEvC,MAAA,CAAAwC,OAAO;IAAGC,QAAM,EAAEzC,MAAA,CAAAyC,QAAQ;IAAE,aAAW,EAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}