{"ast":null,"code":"import _objectSpread from \"E:/vue3/pet-home-master/pet-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/web.timers.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport { reactive, toRefs, ref } from \"vue\";\nimport { userStore } from \"@/store/user.js\";\nimport { timeInterval } from \"@/utils/tool.js\";\nexport default {\n  props: {\n    recordList: {\n      type: Array,\n      \"default\": []\n    }\n  },\n  setup: function setup(props) {\n    var uStore = userStore();\n    var state = reactive({\n      userName: uStore.getUserName(),\n      btnDelete: false\n    });\n    var touchstart = function touchstart(index) {\n      var timeout = setTimeout(function () {\n        props.recordList[index].btnDelete = true;\n      }, 1000);\n      // clearTimeout(timeout);\n    };\n\n    var initBtnDelete = function initBtnDelete() {\n      props.recordList.forEach(function (item) {\n        item.btnDelete = false;\n      });\n    };\n    var deleteRecode = function deleteRecode(recordid) {\n      uStore.deleteRecordSync(recordid);\n    };\n    return _objectSpread(_objectSpread({}, toRefs(state)), {}, {\n      timeInterval: timeInterval,\n      touchstart: touchstart,\n      initBtnDelete: initBtnDelete,\n      deleteRecode: deleteRecode\n    });\n  }\n};","map":{"version":3,"names":["reactive","toRefs","ref","userStore","timeInterval","props","recordList","type","Array","setup","uStore","state","userName","getUserName","btnDelete","touchstart","index","timeout","setTimeout","initBtnDelete","forEach","item","deleteRecode","recordid","deleteRecordSync","_objectSpread"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\pages\\chatPage\\components\\ChatList.vue"],"sourcesContent":["<template>\n  <div class=\"list_page\" @click=\"initBtnDelete\">\n    <TransitionGroup name=\"list\">\n      <div\n        class=\"list_item\"\n        v-for=\"(item, index) in recordList\"\n        :key=\"item\"\n        :class=\"item.sender === userName ? 'list_item_user' : ''\"\n      >\n        <div class=\"user_img\">\n          <van-image\n            width=\"1.2rem\"\n            height=\"1.2rem\"\n            fit=\"cover\"\n            :src=\"\n              require('@/assets/imgs/user_photo/' + item.senderimg + '.png')\n            \"\n          />\n        </div>\n        <div class=\"chat_content\" @touchstart=\"touchstart(index)\">\n          <div class=\"time_wrap\">\n            <span>{{ timeInterval(item.mtime, 1) }}</span>\n          </div>\n          <div class=\"content_wrap\">\n            <span>{{ item.msg }}</span>\n            <!-- <span>{{recordList}}</span> -->\n          </div>\n        </div>\n        <div class=\"tool_wrap\" v-if=\"item.btnDelete\" @click=\"deleteRecode(item.chatrecordid)\">\n          <span>删除</span>\n        </div>\n      </div>\n    </TransitionGroup>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, ref } from \"vue\";\nimport { userStore } from \"@/store/user.js\";\nimport { timeInterval } from \"@/utils/tool.js\";\n\nexport default {\n  props: {\n    recordList: {\n      type: Array,\n      default: [],\n    },\n  },\n  setup(props) {\n    const uStore = userStore();\n    const state = reactive({\n      userName: uStore.getUserName(),\n      btnDelete: false\n    });\n\n    const touchstart = index => {\n      const timeout = setTimeout(() => {\n        props.recordList[index].btnDelete = true;\n      }, 1000)\n      // clearTimeout(timeout);\n    };\n\n    const initBtnDelete = () => {\n      props.recordList.forEach(item => {\n        item.btnDelete = false;\n      })\n    };\n\n    const deleteRecode = recordid => {\n      uStore.deleteRecordSync(recordid);\n    };\n\n    return {\n      ...toRefs(state),\n      timeInterval,\n      touchstart,\n      initBtnDelete,\n      deleteRecode\n    };\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.list_page {\n  width: 100%;\n  min-height: 100%;\n  padding: 0.3rem 0.1rem;\n  box-sizing: border-box;\n  .list_item {\n    width: 100%;\n    margin-bottom: 0.39rem;\n    display: flex;\n    .user_img {\n      width: 1.2rem;\n      height: 1.2rem;\n      flex: 0 0 1.2rem;\n      margin: 0 0.3rem;\n      border-radius: 50%;\n      overflow: hidden;\n    }\n    .chat_content {\n      max-width: 57%;\n      background-color: #fff;\n      padding: 0.3rem;\n      border-radius: 0 0.35rem 0.35rem 0.35rem;\n      position: relative;\n      .time_wrap {\n        color: @card-color;\n        font-size: 0.2rem;\n        margin-bottom: 0.1rem;\n      }\n      .content_wrap {\n        color: @color-chat-title;\n        font-size: 0.4rem;\n        & > span {\n          line-height: 0.46rem;\n          display: inline-block;\n          word-break: break-all;\n          white-space: normal;\n        }\n        // text-overflow: ellipsis;\n      }\n    }\n    .tool_wrap{\n      box-sizing: border-box;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      margin: 0 .3rem;\n      &>span{\n        text-align: center;\n        display: inline-block;\n        width: 0.9rem;\n        font-size: .3rem;\n        line-height: .4rem;\n        color: #fff;\n        padding: .2rem .3rem;\n        border-radius: .3rem;\n        background-color:@btn-delete;\n        \n      }\n    }\n  }\n  .list_item_user {\n    flex-direction: row-reverse;\n    .chat_content {\n      border-radius: 0.35rem 0 0.35rem 0.35rem;\n      background-color: @primary;\n      .time_wrap {\n        color: @color-text-header;\n      }\n      .content_wrap {\n        color: #fff;\n      }\n    }\n  }\n}\n\n.list-move, /* 对移动中的元素应用的过渡 */\n.list-enter-active {\n  transition: all 0.5s ease;\n}\n.list-leave-active {\n  transition: all 0.5s cubic-bezier(0.55, 0, 0.1, 1);\n}\n\n.list-enter-from {\n  opacity: 0;\n  transform: translateX(30px);\n}\n.list-leave-to {\n  opacity: 0;\n  transform: scaleY(0.01) translate(30px, 0);\n}\n\n/* 确保将离开的元素从布局流中删除\n  以便能够正确地计算移动的动画。 */\n.list-leave-active {\n  position: absolute;\n}\n</style>\n"],"mappings":";;;;;AAqCA,SAASA,QAAQ,EAAEC,MAAM,EAAEC,GAAE,QAAS,KAAK;AAC3C,SAASC,SAAQ,QAAS,iBAAiB;AAC3C,SAASC,YAAW,QAAS,iBAAiB;AAE9C,eAAe;EACbC,KAAK,EAAE;IACLC,UAAU,EAAE;MACVC,IAAI,EAAEC,KAAK;MACX,WAAS;IACX;EACF,CAAC;EACDC,KAAK,WAAAA,MAACJ,KAAK,EAAE;IACX,IAAMK,MAAK,GAAIP,SAAS,EAAE;IAC1B,IAAMQ,KAAI,GAAIX,QAAQ,CAAC;MACrBY,QAAQ,EAAEF,MAAM,CAACG,WAAW,EAAE;MAC9BC,SAAS,EAAE;IACb,CAAC,CAAC;IAEF,IAAMC,UAAS,GAAI,SAAbA,UAASA,CAAIC,KAAI,EAAK;MAC1B,IAAMC,OAAM,GAAIC,UAAU,CAAC,YAAM;QAC/Bb,KAAK,CAACC,UAAU,CAACU,KAAK,CAAC,CAACF,SAAQ,GAAI,IAAI;MAC1C,CAAC,EAAE,IAAI;MACP;IACF,CAAC;;IAED,IAAMK,aAAY,GAAI,SAAhBA,aAAYA,CAAA,EAAU;MAC1Bd,KAAK,CAACC,UAAU,CAACc,OAAO,CAAC,UAAAC,IAAG,EAAK;QAC/BA,IAAI,CAACP,SAAQ,GAAI,KAAK;MACxB,CAAC;IACH,CAAC;IAED,IAAMQ,YAAW,GAAI,SAAfA,YAAWA,CAAIC,QAAO,EAAK;MAC/Bb,MAAM,CAACc,gBAAgB,CAACD,QAAQ,CAAC;IACnC,CAAC;IAED,OAAAE,aAAA,CAAAA,aAAA,KACKxB,MAAM,CAACU,KAAK,CAAC;MAChBP,YAAY,EAAZA,YAAY;MACZW,UAAU,EAAVA,UAAU;MACVI,aAAa,EAAbA,aAAa;MACbG,YAAW,EAAXA;IAAW;EAEf;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}