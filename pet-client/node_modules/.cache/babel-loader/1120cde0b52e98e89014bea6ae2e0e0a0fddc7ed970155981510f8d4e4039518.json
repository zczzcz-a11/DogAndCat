{"ast":null,"code":"import _objectSpread from \"E:/vue3/pet-home-master/pet-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport { reactive, toRefs, ref } from 'vue';\nimport { toRelatedPage, back } from '@/router/tool.js';\nimport { useRoute, useRouter } from 'vue-router';\nimport { petSpaceById } from '@/axios/index.js';\nimport { userStore } from '@/store/user.js';\nimport { Toast } from 'vant';\nexport default {\n  setup: function setup(props) {\n    var uStore = userStore();\n    var route = useRoute();\n    var router = useRouter();\n    var _route$query = route.query,\n      petid = _route$query.petid,\n      hostid = _route$query.hostid;\n    var state = reactive({\n      collect: false,\n      // 收藏状态\n      petInfo: {},\n      // 宠物信息\n      userInfo: {\n        userimg: 'user_001'\n      },\n      // 用户信息\n      queryInfo: {\n        userId: ''\n      },\n      chetInfo: {},\n      tabsHeaderRef: ref(null),\n      petWrap: ref(null),\n      startY: '',\n      endY: ''\n    });\n    var petSpaceByIdSnyc = function petSpaceByIdSnyc(petid, hostid) {\n      petSpaceById({\n        petid: petid,\n        hostid: hostid\n      }).then(function (res) {\n        state.petInfo = _objectSpread({}, res.data.petInfo);\n        state.userInfo = _objectSpread({}, res.data.userInfo);\n        state.queryInfo.userId = res.data.userInfo.id;\n        state.chetInfo = {\n          chatId: state.userInfo.id,\n          chatName: state.userInfo.username,\n          chatImg: state.userInfo.userimg\n        };\n        var chatList = uStore.getChatList();\n        state.chetInfo.listId = '';\n        chatList.forEach(function (item) {\n          if (item.userId == state.chetInfo.chatId) {\n            state.chetInfo.listId = item.id;\n          }\n        });\n      });\n    };\n    petSpaceByIdSnyc(petid, hostid);\n    uStore.getCollectByPetId(petid).then(function (res) {\n      state.collect = res;\n    });\n    var touchstart = function touchstart(event) {\n      var touch = event.touches[0];\n      state.startY = touch.pageY;\n    };\n    var touchmove = function touchmove(event) {\n      var touch = event.touches[0];\n      state.endY = state.startY - touch.pageY;\n    };\n    var touchend = function touchend(event) {\n      if (state.endY > 0) {\n        state.tabsHeaderRef.style.height = 'calc(100% - 5rem)';\n        state.petWrap.style.filter = 'blur(.1rem)';\n        state.petWrap.style.transform = 'scale(1.2)';\n      } else if (state.endY < 0) {\n        state.tabsHeaderRef.style.height = 'calc(100% - 10rem)';\n        state.petWrap.style.filter = 'blur(0rem)';\n        state.petWrap.style.transform = 'scale(1)';\n      }\n      state.endY = 0;\n    };\n    var cardColl = function cardColl(id) {\n      // 点击心形收藏改变样式\n      uStore.setFondCollectSync(id).then(function (res) {\n        state.collect = res;\n      });\n    };\n    var toChatPage = function toChatPage() {\n      var name = uStore.getUserName();\n      if (name === state.userInfo.username) {\n        Toast.fail('不可以向自己发消息');\n      } else {\n        toRelatedPage('chatPage', router, 500, state.chetInfo);\n      }\n    };\n    return _objectSpread(_objectSpread({}, toRefs(state)), {}, {\n      router: router,\n      toRelatedPage: toRelatedPage,\n      back: back,\n      cardColl: cardColl,\n      touchstart: touchstart,\n      touchmove: touchmove,\n      touchend: touchend,\n      toChatPage: toChatPage\n    });\n  },\n  components: {}\n};","map":{"version":3,"names":["reactive","toRefs","ref","toRelatedPage","back","useRoute","useRouter","petSpaceById","userStore","Toast","setup","props","uStore","route","router","_route$query","query","petid","hostid","state","collect","petInfo","userInfo","userimg","queryInfo","userId","chetInfo","tabsHeaderRef","petWrap","startY","endY","petSpaceByIdSnyc","then","res","_objectSpread","data","id","chatId","chatName","username","chatImg","chatList","getChatList","listId","forEach","item","getCollectByPetId","touchstart","event","touch","touches","pageY","touchmove","touchend","style","height","filter","transform","cardColl","setFondCollectSync","toChatPage","name","getUserName","fail","components"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\pages\\petSpace\\index.vue"],"sourcesContent":["<template>\n  <div class=\"page\">\n    <div class=\"page_head\">\n      <div @click=\"back(router)\">\n        <i class=\"iconfont icon-arrowLeft-fill\"></i>\n      </div>\n      <div @click.stop=\"cardColl(petInfo.petid)\" class=\"floatBox\">\n        <i class=\"iconfont icon-xin2 iconColl2\" v-if=\"collect\"></i>\n        <i class=\"iconfont icon-xin2 iconColl1\" v-else></i>\n      </div>\n    </div>\n\n    <div class=\"pet_wrap\" ref=\"petWrap\">\n      <van-image width=\"100%\" height=\"11rem\" fit=\"cover\" :src=\"petInfo.petimg\" show-loading />\n    </div>\n\n    <div class=\"content_wrap\" ref=\"tabsHeaderRef\" @touchstart=\"touchstart\" @touchmove=\"touchmove\" @touchend=\"touchend\">\n      <div class=\"name_wrap\">\n        <div class=\"name_content\">\n          <span class=\"name\">{{ petInfo.petname }}</span>\n          <span class=\"age\">（{{ petInfo.petage }}岁）</span>\n        </div>\n        <div class=\"icon_wrap\">\n          <i class=\"iconfont icon-dingwei\"></i>\n          <span class=\"location\">北京</span>\n        </div>\n      </div>\n\n      <div class=\"info_wrap\">\n        <div class=\"info_item\">\n          <span class=\"info_data\">{{ petInfo.petsex === '1' ? '雄' : '雌' }}</span>\n          <span class=\"info_name\">性别</span>\n        </div>\n        <div class=\"info_item\">\n          <span class=\"info_data\">{{ petInfo.petcolor }}</span>\n          <span class=\"info_name\">颜色</span>\n        </div>\n        <div class=\"info_item\">\n          <span class=\"info_data\">{{ petInfo.petbreed }}</span>\n          <span class=\"info_name\">品种</span>\n        </div>\n        <div class=\"info_item\">\n          <span class=\"info_data\">{{ petInfo.petweight }}kg</span>\n          <span class=\"info_name\">重量</span>\n        </div>\n      </div>\n\n      <div class=\"host_wrap\">\n        <div class=\"host_img\">\n          <van-image width=\"1.4rem\" height=\"1.4rem\" fit=\"cover\" :src=\"require('@/assets/imgs/user_photo/' + userInfo.userimg + '.png')\" />\n        </div>\n        <div class=\"host_name\">\n          <span class=\"first\">Owner by.</span>\n          <span class=\"name\">{{ userInfo.username }}</span>\n        </div>\n\n        <div class=\"host_session\" @click=\"toRelatedPage('userSpace', router, 0, queryInfo)\">\n          <i class=\"iconfont icon-wode\"></i>\n        </div>\n        <div class=\"host_session\" @click=\"toChatPage\">\n          <i class=\"iconfont icon-008duihuakuang-6\"></i>\n        </div>\n      </div>\n\n      <div class=\"sign_wrap\">\n        {{ petInfo.petmessage }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, ref } from 'vue'\nimport { toRelatedPage, back } from '@/router/tool.js'\nimport { useRoute, useRouter } from 'vue-router'\nimport { petSpaceById } from '@/axios/index.js'\nimport { userStore } from '@/store/user.js'\nimport { Toast } from 'vant'\n\nexport default {\n  setup(props) {\n    const uStore = userStore()\n    const route = useRoute()\n    const router = useRouter()\n    const { petid, hostid } = route.query\n    const state = reactive({\n      collect: false, // 收藏状态\n      petInfo: {}, // 宠物信息\n      userInfo: {\n        userimg: 'user_001'\n      }, // 用户信息\n      queryInfo: {\n        userId: ''\n      },\n      chetInfo: {},\n      tabsHeaderRef: ref(null),\n      petWrap: ref(null),\n      startY: '',\n      endY: ''\n    })\n\n    const petSpaceByIdSnyc = (petid, hostid) => {\n      petSpaceById({ petid, hostid }).then(res => {\n        state.petInfo = { ...res.data.petInfo }\n        state.userInfo = { ...res.data.userInfo }\n        state.queryInfo.userId = res.data.userInfo.id\n        state.chetInfo = {\n          chatId: state.userInfo.id,\n          chatName: state.userInfo.username,\n          chatImg: state.userInfo.userimg\n        }\n        const chatList = uStore.getChatList()\n        state.chetInfo.listId = ''\n        chatList.forEach(item => {\n          if (item.userId == state.chetInfo.chatId) {\n            state.chetInfo.listId = item.id\n          }\n        })\n      })\n    }\n    petSpaceByIdSnyc(petid, hostid)\n\n    uStore.getCollectByPetId(petid).then(res => {\n      state.collect = res\n    })\n\n    const touchstart = event => {\n      let touch = event.touches[0]\n      state.startY = touch.pageY\n    }\n    const touchmove = event => {\n      let touch = event.touches[0]\n      state.endY = state.startY - touch.pageY\n    }\n    const touchend = event => {\n      if (state.endY > 0) {\n        state.tabsHeaderRef.style.height = 'calc(100% - 5rem)'\n        state.petWrap.style.filter = 'blur(.1rem)'\n        state.petWrap.style.transform = 'scale(1.2)'\n      } else if (state.endY < 0) {\n        state.tabsHeaderRef.style.height = 'calc(100% - 10rem)'\n        state.petWrap.style.filter = 'blur(0rem)'\n        state.petWrap.style.transform = 'scale(1)'\n      }\n      state.endY = 0\n    }\n\n    const cardColl = id => {\n      // 点击心形收藏改变样式\n      uStore.setFondCollectSync(id).then(res => {\n        state.collect = res\n      })\n    }\n\n    const toChatPage = () => {\n      const name = uStore.getUserName()\n      if (name === state.userInfo.username) {\n        Toast.fail('不可以向自己发消息')\n      } else {\n        toRelatedPage('chatPage', router, 500, state.chetInfo)\n      }\n    }\n\n    return {\n      ...toRefs(state),\n      router,\n      toRelatedPage,\n      back,\n      cardColl,\n      touchstart,\n      touchmove,\n      touchend,\n      toChatPage\n    }\n  },\n  components: {}\n}\n</script>\n\n<style lang=\"less\" scoped>\n.page {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  background-color: @primary;\n  overflow: hidden;\n  .page_head {\n    width: 100%;\n    height: 1.6rem;\n    padding: 20px;\n    box-sizing: border-box;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 0.5rem;\n    color: @color-text-header;\n    position: absolute;\n    z-index: 100;\n    i {\n      color: #5e5b5b;\n      font-size: 0.6rem;\n      background-color: #fff;\n      padding: 0.2rem;\n      border-radius: 0.3rem;\n    }\n    .floatBox {\n      .iconColl1 {\n        // font-size: 0.5rem;\n        color: #d8d8d8;\n      }\n      .iconColl2 {\n        // font-size: 0.5rem;\n        color: #ff6969;\n      }\n      i {\n        padding: 0.19rem 0.23rem 0.21rem 0.2rem;\n      }\n    }\n  }\n  .pet_wrap {\n    width: 100%;\n    height: 11rem;\n    transition: all 0.2s ease-in;\n  }\n  .content_wrap::before {\n    content: '';\n    width: 1.5rem;\n    height: 2px;\n    border-radius: 2px;\n    background-color: @primary;\n    position: absolute;\n    top: 0.2rem;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n  .content_wrap {\n    width: 100%;\n    height: calc(100% - 10rem);\n    border-radius: 32px 32px 0 0;\n    padding: 40px 20px;\n    box-sizing: border-box;\n    background-color: @primary-bg;\n    border-top: 4px solid #683931;\n    position: absolute;\n    bottom: 0;\n    transition: all 0.2s ease-in-out;\n    & > div {\n      width: 100%;\n      margin-bottom: 0.6rem;\n    }\n    .name_wrap {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      .name_content {\n        display: flex;\n        align-items: center;\n        .name {\n          max-width: 5rem;\n          .line-clamp1();\n          color: #5e5b5b;\n          font-size: 0.6rem;\n          font-weight: 800;\n        }\n        .age {\n          color: @card-color;\n          font-size: 0.4rem;\n        }\n      }\n      .icon_wrap {\n        display: flex;\n        align-items: center;\n        & > i {\n          color: @primary;\n          font-size: 0.6rem;\n          font-weight: 800;\n          line-height: 0.9rem;\n        }\n        .location {\n          font-size: 0.35rem;\n          color: @card-color;\n        }\n      }\n    }\n    .info_wrap {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      .info_item {\n        width: 2rem;\n        padding: 0.3rem;\n        box-sizing: border-box;\n        border: 1px solid #8d9f5e41;\n        border-radius: 0.3rem;\n        text-align: center;\n        & > span {\n          display: block;\n          line-height: 0.5rem;\n        }\n        .info_data {\n          .line-clamp1();\n          font-size: 0.4rem;\n          color: @primary;\n        }\n        .info_name {\n          font-size: 0.1rem;\n          color: @card-color;\n          transform: scale(0.9);\n        }\n      }\n    }\n    .host_wrap {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      .host_img {\n        width: 1.4rem;\n        height: 1.4rem;\n        border-radius: 50%;\n        overflow: hidden;\n      }\n      .host_name {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-evenly;\n        transform-origin: 0%;\n        transform: scale(0.8);\n        margin-left: 10px;\n        .first {\n          font-size: 0.1rem;\n          line-height: 0.4rem;\n          color: @card-color;\n        }\n        .name {\n          .line-clamp1();\n          font-size: 0.5rem;\n          font-weight: 600;\n          line-height: 0.7rem;\n          color: #5e5b5b;\n        }\n      }\n      .host_session {\n        width: 1rem;\n        height: 1rem;\n        background-color: @primary;\n        border-radius: 50%;\n        // padding: 0.2rem;\n        text-align: center;\n        margin-left: 0.3rem;\n        & > i {\n          color: #fff;\n          font-size: 0.6rem;\n          font-weight: 800;\n          line-height: 1rem;\n        }\n      }\n    }\n    .sign_wrap {\n      color: @card-color;\n      font-size: 0.35rem;\n      line-height: 0.56rem;\n    }\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}