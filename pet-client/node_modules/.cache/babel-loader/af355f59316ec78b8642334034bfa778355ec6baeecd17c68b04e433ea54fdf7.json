{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport config from './config.js';\nimport { Toast } from 'vant';\nimport router from '@/router/index.js';\nexport default function $axios(options) {\n  return new Promise(function (resolve, reject) {\n    var instance = axios.create({\n      baseURL: config.baseUrl,\n      timeout: config.timeout,\n      headers: {}\n    });\n\n    // 请求拦截\n    instance.interceptors.request.use(function (conf) {\n      // 带上 token 给后端\n      conf.headers['Authorization'] = \"\".concat(localStorage.getItem('token') || '');\n      return conf;\n    }, function (error) {\n      console.log(666);\n      console.log(error);\n    });\n\n    // 响应拦截\n    instance.interceptors.response.use(function (response) {\n      var data = response.data;\n      if (data.code !== 200) {\n        // 业务逻辑错误\n        if (data.mess) Toast.fail(data.mess);\n        return Promise.reject(data);\n      }\n      return data;\n    }, function (err) {\n      // 后端服务器错误\n      if (err && err.response) {\n        switch (err.response.status) {\n          case 400:\n            err.mess = '请求错误';\n            break;\n          case 401:\n            err.mess = '账号已过期,请重新登录';\n            Toast.fail(err.mess);\n            router.push('/login');\n            break;\n          case 404:\n            err.mess = '请求地址错误';\n            break;\n          default:\n        }\n      }\n      return Promise.reject(err);\n    });\n\n    // 发生请求\n    instance(options).then(function (res) {\n      resolve(res);\n    })[\"catch\"](function (error) {\n      reject(error);\n    });\n  });\n}","map":{"version":3,"names":["axios","config","Toast","router","$axios","options","Promise","resolve","reject","instance","create","baseURL","baseUrl","timeout","headers","interceptors","request","use","conf","concat","localStorage","getItem","error","console","log","response","data","code","mess","fail","err","status","push","then","res"],"sources":["E:/vue3/pet-home-master/pet-client/src/axios/api.js"],"sourcesContent":["import axios from \"axios\";\nimport config from './config.js';\nimport { Toast } from 'vant';\nimport router from '@/router/index.js'\n\nexport default function $axios(options){\n\n    return new Promise((resolve, reject)=>{\n\n        const instance = axios.create({\n            baseURL: config.baseUrl,\n            timeout: config.timeout,\n            headers: {},\n        })\n\n        // 请求拦截\n        instance.interceptors.request.use(\n            conf =>{\n                // 带上 token 给后端\n                conf.headers['Authorization'] = `${localStorage.getItem('token') || ''}`;\n                return conf\n            },\n            error => {\n                console.log(666);\n                console.log(error);\n            }\n        )\n\n        // 响应拦截\n        instance.interceptors.response.use(\n            response =>{\n                let data = response.data\n                if(data.code !== 200){  // 业务逻辑错误\n                    if(data.mess)  Toast.fail(data.mess)\n                    return Promise.reject(data)\n                } \n                return data\n            },\n            err =>{  // 后端服务器错误\n                if(err && err.response){\n                    switch(err.response.status){\n                        case 400:\n                            err.mess = '请求错误'\n                        break\n                        case 401:\n                            err.mess = '账号已过期,请重新登录'\n                            Toast.fail(err.mess)\n                            router.push('/login')\n                        break\n                        case 404:\n                            err.mess = '请求地址错误'\n                        break\n                        default:\n                        \n                    }\n                }\n                return Promise.reject(err)\n            }\n        )\n   \n        // 发生请求\n        instance(options).then(res=>{\n            resolve(res)\n        })\n        .catch(error=>{\n            reject(error)\n        })\n        \n    })\n}\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,aAAa;AAChC,SAASC,KAAK,QAAQ,MAAM;AAC5B,OAAOC,MAAM,MAAM,mBAAmB;AAEtC,eAAe,SAASC,MAAMA,CAACC,OAAO,EAAC;EAEnC,OAAO,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAG;IAElC,IAAMC,QAAQ,GAAGT,KAAK,CAACU,MAAM,CAAC;MAC1BC,OAAO,EAAEV,MAAM,CAACW,OAAO;MACvBC,OAAO,EAAEZ,MAAM,CAACY,OAAO;MACvBC,OAAO,EAAE,CAAC;IACd,CAAC,CAAC;;IAEF;IACAL,QAAQ,CAACM,YAAY,CAACC,OAAO,CAACC,GAAG,CAC7B,UAAAC,IAAI,EAAG;MACH;MACAA,IAAI,CAACJ,OAAO,CAAC,eAAe,CAAC,MAAAK,MAAA,CAAMC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,CAAE;MACxE,OAAOH,IAAI;IACf,CAAC,EACD,UAAAI,KAAK,EAAI;MACLC,OAAO,CAACC,GAAG,CAAC,GAAG,CAAC;MAChBD,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;IACtB,CAAC,CACJ;;IAED;IACAb,QAAQ,CAACM,YAAY,CAACU,QAAQ,CAACR,GAAG,CAC9B,UAAAQ,QAAQ,EAAG;MACP,IAAIC,IAAI,GAAGD,QAAQ,CAACC,IAAI;MACxB,IAAGA,IAAI,CAACC,IAAI,KAAK,GAAG,EAAC;QAAG;QACpB,IAAGD,IAAI,CAACE,IAAI,EAAG1B,KAAK,CAAC2B,IAAI,CAACH,IAAI,CAACE,IAAI,CAAC;QACpC,OAAOtB,OAAO,CAACE,MAAM,CAACkB,IAAI,CAAC;MAC/B;MACA,OAAOA,IAAI;IACf,CAAC,EACD,UAAAI,GAAG,EAAG;MAAG;MACL,IAAGA,GAAG,IAAIA,GAAG,CAACL,QAAQ,EAAC;QACnB,QAAOK,GAAG,CAACL,QAAQ,CAACM,MAAM;UACtB,KAAK,GAAG;YACJD,GAAG,CAACF,IAAI,GAAG,MAAM;YACrB;UACA,KAAK,GAAG;YACJE,GAAG,CAACF,IAAI,GAAG,aAAa;YACxB1B,KAAK,CAAC2B,IAAI,CAACC,GAAG,CAACF,IAAI,CAAC;YACpBzB,MAAM,CAAC6B,IAAI,CAAC,QAAQ,CAAC;YACzB;UACA,KAAK,GAAG;YACJF,GAAG,CAACF,IAAI,GAAG,QAAQ;YACvB;UACA;QAAQ;MAGhB;MACA,OAAOtB,OAAO,CAACE,MAAM,CAACsB,GAAG,CAAC;IAC9B,CAAC,CACJ;;IAED;IACArB,QAAQ,CAACJ,OAAO,CAAC,CAAC4B,IAAI,CAAC,UAAAC,GAAG,EAAE;MACxB3B,OAAO,CAAC2B,GAAG,CAAC;IAChB,CAAC,CAAC,SACI,CAAC,UAAAZ,KAAK,EAAE;MACVd,MAAM,CAACc,KAAK,CAAC;IACjB,CAAC,CAAC;EAEN,CAAC,CAAC;AACN"},"metadata":{},"sourceType":"module","externalDependencies":[]}