{"ast":null,"code":"import _objectSpread from \"E:/vue3/pet-home-master/pet-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { reactive, toRefs, ref } from 'vue';\nimport { useRouter } from 'vue-router';\nimport VueImageVerifyVue from './components/VueImageVerify.vue';\nimport { login, register } from '@/axios/index.js';\nimport { Toast } from 'vant';\nimport { userStore } from '@/store/user.js';\nexport default {\n  components: {\n    // Header,\n    VueImageVerifyVue: VueImageVerifyVue\n  },\n  setup: function setup() {\n    var router = useRouter(); // 得到路由实例\n    var verifyRef = ref(null);\n    var uStore = userStore(); // 仓库的上下文对象\n    var state = reactive({\n      username: '',\n      password: '',\n      verify: '',\n      imgCode: '',\n      type: 'login'\n    });\n\n    // 登录或注册信息提交\n    var onSubmit = function onSubmit() {\n      if (state.type == 'login') {\n        // 登录按钮\n        uStore.loginByUserNameSync(state.username, state.password).then(function (res) {\n          Toast.success(res);\n          router.push('/home');\n        });\n      } else {\n        // 注册按钮\n        if (state.verify !== state.imgCode) {\n          Toast.fail('验证码错误');\n          return;\n        }\n        register({\n          username: state.username,\n          password: state.password,\n          userimg: 'user_001',\n          usersign: '今日份营业汪 ! ! !'\n        }).then(function (res) {\n          if (res.code) Toast.success(res.mess);\n          state.type = 'login';\n        });\n      }\n    };\n\n    // 切换登录注册\n    var changType = function changType(type) {\n      state.type = type;\n    };\n\n    // 获取子组件传递过来的imgCode\n    var getImgCode = function getImgCode(val) {\n      state.imgCode = val;\n      console.log(state.imgCode);\n    };\n    return _objectSpread(_objectSpread({}, toRefs(state)), {}, {\n      onSubmit: onSubmit,\n      changType: changType,\n      verifyRef: verifyRef,\n      getImgCode: getImgCode\n    });\n  }\n};","map":{"version":3,"names":["reactive","toRefs","ref","useRouter","VueImageVerifyVue","login","register","Toast","userStore","components","setup","router","verifyRef","uStore","state","username","password","verify","imgCode","type","onSubmit","loginByUserNameSync","then","res","success","push","fail","userimg","usersign","code","mess","changType","getImgCode","val","console","log","_objectSpread"],"sources":["E:\\vue3\\pet-home-master\\pet-client\\src\\views\\login\\index.vue"],"sourcesContent":["<template>\n  <div class=\"page\">\n    <div class=\"header\">\n      <p>Hello!</p>\n      <p>Good to see you here</p>\n    </div>\n\n    <div class=\"main_wrap\">\n      <img src=\"@/assets/icons/login.svg\" class=\"login_icon\" />\n\n      <!-- login -->\n      <van-form @submit=\"onSubmit\" v-if=\"type === 'login'\" class=\"form\">\n        <van-cell-group inset>\n          <van-field v-model=\"username\" name=\"username\" label=\"用户名\" placeholder=\"用户名\" :rules=\"[{ required: true, message: '请填写用户名' }]\" />\n          <van-field v-model=\"password\" type=\"password\" name=\"password\" label=\"密码\" placeholder=\"密码\" :rules=\"[{ required: true, message: '请填写密码' }]\" />\n        </van-cell-group>\n        <div style=\"margin: 16px\">\n          <van-button round block type=\"primary\" native-type=\"submit\" class=\"login_btn\">登录</van-button>\n          <p class=\"change_btn\" @click=\"changType('register')\">没有账号，前往注册</p>\n        </div>\n      </van-form>\n\n      <!-- register -->\n      <van-form @submit=\"onSubmit\" v-else class=\"form\">\n        <van-cell-group inset>\n          <van-field v-model=\"username\" name=\"username\" label=\"用户名\" placeholder=\"用户名\" :rules=\"[{ required: true, message: '请填写用户名' }]\" />\n          <van-field v-model=\"password\" type=\"password\" name=\"password\" label=\"密码\" placeholder=\"密码\" :rules=\"[{ required: true, message: '请填写密码' }]\" />\n          <van-field v-model=\"verify\" name=\"verify\" label=\"验证码\" placeholder=\"验证码\" :rules=\"[{ required: true, message: '请填写验证码' }]\">\n            <template #button>\n              <VueImageVerifyVue ref=\"verifyRef\" @sendImgCode=\"getImgCode\" />\n            </template>\n          </van-field>\n        </van-cell-group>\n        <div style=\"margin: 16px\">\n          <van-button round block type=\"primary\" native-type=\"submit\" class=\"login_btn\">注册</van-button>\n          <p class=\"change_btn\" @click=\"changType('login')\">已有账号，点击登录</p>\n        </div>\n      </van-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport VueImageVerifyVue from './components/VueImageVerify.vue'\nimport { login, register } from '@/axios/index.js'\nimport { Toast } from 'vant'\nimport { userStore } from '@/store/user.js'\n\nexport default {\n  components: {\n    // Header,\n    VueImageVerifyVue\n  },\n  setup() {\n    const router = useRouter() // 得到路由实例\n    const verifyRef = ref(null)\n    const uStore = userStore() // 仓库的上下文对象\n    const state = reactive({\n      username: '',\n      password: '',\n      verify: '',\n      imgCode: '',\n      type: 'login'\n    })\n\n    // 登录或注册信息提交\n    const onSubmit = () => {\n      if (state.type == 'login') {\n        // 登录按钮\n        uStore.loginByUserNameSync(state.username, state.password).then(res => {\n          Toast.success(res)\n          router.push('/home')\n        })\n      } else {\n        // 注册按钮\n        if (state.verify !== state.imgCode) {\n          Toast.fail('验证码错误')\n          return\n        }\n        register({\n          username: state.username,\n          password: state.password,\n          userimg: 'user_001',\n          usersign: '今日份营业汪 ! ! !'\n        }).then(res => {\n          if (res.code) Toast.success(res.mess)\n          state.type = 'login'\n        })\n      }\n    }\n\n    // 切换登录注册\n    const changType = type => {\n      state.type = type\n    }\n\n    // 获取子组件传递过来的imgCode\n    const getImgCode = val => {\n      state.imgCode = val\n      console.log(state.imgCode)\n    }\n\n    return {\n      ...toRefs(state),\n      onSubmit,\n      changType,\n      verifyRef,\n      getImgCode\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.page {\n  width: 100%;\n  height: 100%;\n  background-color: @primary;\n  .header {\n    width: 100%;\n    padding: 20px;\n    box-sizing: border-box;\n    font-size: 35px;\n    color: #fff;\n    p:last-child {\n      font-size: 18px;\n      margin-top: 10px;\n    }\n  }\n  .main_wrap {\n    width: 100%;\n    height: calc(100% - 200px);\n    position: absolute;\n    bottom: 0;\n    background-color: #fff;\n    border-radius: 47px 47px 0 0;\n    border-top: 4px solid #683931;\n    .login_icon {\n      position: absolute;\n      bottom: 100%;\n      right: 0;\n      transform: translate(-12%, 25%);\n    }\n    .form {\n      margin-top: 1rem;\n      .login_btn {\n        margin-top: 1rem;\n        background-color: @primary;\n        border: none;\n      }\n      .change_btn {\n        text-align: center;\n        margin: 1rem 0;\n        color: @primary;\n        font-size: 14px;\n      }\n    }\n  }\n}\n</style>\n"],"mappings":";;AA2CA,SAASA,QAAQ,EAAEC,MAAM,EAAEC,GAAE,QAAS,KAAI;AAC1C,SAASC,SAAQ,QAAS,YAAW;AACrC,OAAOC,iBAAgB,MAAO,iCAAgC;AAC9D,SAASC,KAAK,EAAEC,QAAO,QAAS,kBAAiB;AACjD,SAASC,KAAI,QAAS,MAAK;AAC3B,SAASC,SAAQ,QAAS,iBAAgB;AAE1C,eAAe;EACbC,UAAU,EAAE;IACV;IACAL,iBAAgB,EAAhBA;EACF,CAAC;EACDM,KAAK,WAAAA,MAAA,EAAG;IACN,IAAMC,MAAK,GAAIR,SAAS,EAAC,EAAE;IAC3B,IAAMS,SAAQ,GAAIV,GAAG,CAAC,IAAI;IAC1B,IAAMW,MAAK,GAAIL,SAAS,EAAC,EAAE;IAC3B,IAAMM,KAAI,GAAId,QAAQ,CAAC;MACrBe,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,MAAM,EAAE,EAAE;MACVC,OAAO,EAAE,EAAE;MACXC,IAAI,EAAE;IACR,CAAC;;IAED;IACA,IAAMC,QAAO,GAAI,SAAXA,QAAOA,CAAA,EAAU;MACrB,IAAIN,KAAK,CAACK,IAAG,IAAK,OAAO,EAAE;QACzB;QACAN,MAAM,CAACQ,mBAAmB,CAACP,KAAK,CAACC,QAAQ,EAAED,KAAK,CAACE,QAAQ,CAAC,CAACM,IAAI,CAAC,UAAAC,GAAE,EAAK;UACrEhB,KAAK,CAACiB,OAAO,CAACD,GAAG;UACjBZ,MAAM,CAACc,IAAI,CAAC,OAAO;QACrB,CAAC;MACH,OAAO;QACL;QACA,IAAIX,KAAK,CAACG,MAAK,KAAMH,KAAK,CAACI,OAAO,EAAE;UAClCX,KAAK,CAACmB,IAAI,CAAC,OAAO;UAClB;QACF;QACApB,QAAQ,CAAC;UACPS,QAAQ,EAAED,KAAK,CAACC,QAAQ;UACxBC,QAAQ,EAAEF,KAAK,CAACE,QAAQ;UACxBW,OAAO,EAAE,UAAU;UACnBC,QAAQ,EAAE;QACZ,CAAC,CAAC,CAACN,IAAI,CAAC,UAAAC,GAAE,EAAK;UACb,IAAIA,GAAG,CAACM,IAAI,EAAEtB,KAAK,CAACiB,OAAO,CAACD,GAAG,CAACO,IAAI;UACpChB,KAAK,CAACK,IAAG,GAAI,OAAM;QACrB,CAAC;MACH;IACF;;IAEA;IACA,IAAMY,SAAQ,GAAI,SAAZA,SAAQA,CAAIZ,IAAG,EAAK;MACxBL,KAAK,CAACK,IAAG,GAAIA,IAAG;IAClB;;IAEA;IACA,IAAMa,UAAS,GAAI,SAAbA,UAASA,CAAIC,GAAE,EAAK;MACxBnB,KAAK,CAACI,OAAM,GAAIe,GAAE;MAClBC,OAAO,CAACC,GAAG,CAACrB,KAAK,CAACI,OAAO;IAC3B;IAEA,OAAAkB,aAAA,CAAAA,aAAA,KACKnC,MAAM,CAACa,KAAK,CAAC;MAChBM,QAAQ,EAARA,QAAQ;MACRW,SAAS,EAATA,SAAS;MACTnB,SAAS,EAATA,SAAS;MACToB,UAAS,EAATA;IAAS;EAEb;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}